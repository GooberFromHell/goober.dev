{ "title": "general", 
	"categories": [ "Unix", "Survey", "Enumeration" ], 
	"previous": null, 
	"url": "/commands/Unix%20Survey%20Helper.html", 
	"collection": "commands", 
	"content": "<h4 id=\"directories-leading-to-filename\">directories leading to FileName.</h4>\n<pre><code class=\"language-Shell\">namei -l &lt;/Full/Path/To/The/file&gt;\n</code></pre>\n\n<h4 id=\"ssh-logging-from-linux\">SSH logging from linux</h4>\n<pre><code class=\"language-Shell\">ssh &lt;IpAddress&gt; -u &lt;UserName&gt; | tee &gt;(while read line; do echo \"`date +'[%H:%M:%S]'` $line\"; done &gt;logfile)\n</code></pre>\n\n<h4 id=\"get-all-user-login-times\">get all user login times.</h4>\n<pre><code class=\"language-Shell\">for name in `getent passwd | awk '{split($0,a,\":\"); print(a[1])}'`; do last $name &gt;&gt; /tmp/logins.txt; done\n</code></pre>\n\n<h4 id=\"writes-to-the-master-boot-record-on-the-boot-device\">Writes to the Master Boot Record on the boot device.</h4>\n<pre><code class=\"language-Shell\">echo -n L | dd of=/boot/grub/stage1 bs=1 seek=&lt;OFFSET&gt; conv=notrunc\n</code></pre>\n\n<h4 id=\"compare-boot-directory-files-to-the-mbr\">Compare Boot directory files to the MBR.</h4>\n<pre><code class=\"language-Shell\">dd if=/dev/sda bs=512 count=1 | diff - /boot/grub/stage&lt;StageNumber&gt;\n</code></pre>\n\n<h4 id=\"get-all-user-login-shells\">get all user login shells</h4>\n<pre><code class=\"language-Shell\">getent passwd | awk -F':' '{ print($1\" - \"$7) }'\n</code></pre>\n\n<h4 id=\"display-all-processes-cwd-and-_-environments-good-for-find-an-executables-actual-running-directory-kinda-buggy-but-still-works\">display all processes cwd and _ environments. Good for find an executables actual running directory. (kinda buggy but still works)</h4>\n<pre><code class=\"language-Shell\">for i in $(find /proc -maxdepth 1 -type d); do echo \"$i # `ls -a $i/cwd` # $(cat $i/environ | awk '{ split($0,a,\"=\"); print(a[15]); }')\"; done | grep '# /'\n</code></pre>\n\n<h4 id=\"solaris-get-process-to-port-translation\">Solaris get process to port translation.</h4>\n<pre><code class=\"language-Shell\">pfiles `ls /proc` 2&gt;/dev/null | awk \"/^[^ \\\\t]/{smatch=\\$0; next }/port:[ \\\\t]*${1}/{print smatch, \\$0}{next}\"\n</code></pre>\n<pre><code class=\"language-Shell\">for p in `ls /proc`; do args=$(pargs $p | grep $p:) &amp;&amp; printf \"$args \\n $(pfiles $p | grep port:)\" ; done | less\n</code></pre>\n<pre><code class=\"language-Shell\">find /proc/*/fd/ | xargs grep -sl port:\n</code></pre>\n\n<h4 id=\"solaris-find-port-usage\">Solaris find port usage.</h4>\n<pre><code class=\"language-Shell\">ps -ef| awk '{print $2}'| xargs -I '{}' sh -c 'echo examining process {}; pfiles {}| grep &lt;PortToFind&gt;'\n</code></pre>\n\n<h4 id=\"list-all-users-cron-jobs\">List all users cron jobs</h4>\n<pre><code class=\"language-Shell\">for user in `getent passwd | awk -F':' '{ print $1}'`; do crontab -u $user -l; done\n</code></pre>\n\n<h4 id=\"list-all-varlog-files-used-my-active-processes\">List all /var/log files used my active processes.</h4>\n<pre><code class=\"language-Shell\">cd /proc; for pid in `find * -maxdepth 1 -type d -name \"fd\" -prune`; do ls -l /proc/$pid/. | grep /var/log &amp;&amp; echo $pid\" -------------Above this line--------------\" ; done;\n</code></pre>\n\n<h4 id=\"list-file-created-near-the-same-time\">List file created near the same time.</h4>\n<pre><code class=\"language-Shell\">find -type f -cnewer &lt;FileToCompare&gt; ! -newerct &lt;OneDayLater&gt; -ls\n</code></pre>\n", "id": "/commands/Unix Survey Helper", "output": "<h4 id=\"directories-leading-to-filename\">directories leading to FileName.</h4>\n<pre><code class=\"language-Shell\">namei -l &lt;/Full/Path/To/The/file&gt;\n</code></pre>\n\n<h4 id=\"ssh-logging-from-linux\">SSH logging from linux</h4>\n<pre><code class=\"language-Shell\">ssh &lt;IpAddress&gt; -u &lt;UserName&gt; | tee &gt;(while read line; do echo \"`date +'[%H:%M:%S]'` $line\"; done &gt;logfile)\n</code></pre>\n\n<h4 id=\"get-all-user-login-times\">get all user login times.</h4>\n<pre><code class=\"language-Shell\">for name in `getent passwd | awk '{split($0,a,\":\"); print(a[1])}'`; do last $name &gt;&gt; /tmp/logins.txt; done\n</code></pre>\n\n<h4 id=\"writes-to-the-master-boot-record-on-the-boot-device\">Writes to the Master Boot Record on the boot device.</h4>\n<pre><code class=\"language-Shell\">echo -n L | dd of=/boot/grub/stage1 bs=1 seek=&lt;OFFSET&gt; conv=notrunc\n</code></pre>\n\n<h4 id=\"compare-boot-directory-files-to-the-mbr\">Compare Boot directory files to the MBR.</h4>\n<pre><code class=\"language-Shell\">dd if=/dev/sda bs=512 count=1 | diff - /boot/grub/stage&lt;StageNumber&gt;\n</code></pre>\n\n<h4 id=\"get-all-user-login-shells\">get all user login shells</h4>\n<pre><code class=\"language-Shell\">getent passwd | awk -F':' '{ print($1\" - \"$7) }'\n</code></pre>\n\n<h4 id=\"display-all-processes-cwd-and-_-environments-good-for-find-an-executables-actual-running-directory-kinda-buggy-but-still-works\">display all processes cwd and _ environments. Good for find an executables actual running directory. (kinda buggy but still works)</h4>\n<pre><code class=\"language-Shell\">for i in $(find /proc -maxdepth 1 -type d); do echo \"$i # `ls -a $i/cwd` # $(cat $i/environ | awk '{ split($0,a,\"=\"); print(a[15]); }')\"; done | grep '# /'\n</code></pre>\n\n<h4 id=\"solaris-get-process-to-port-translation\">Solaris get process to port translation.</h4>\n<pre><code class=\"language-Shell\">pfiles `ls /proc` 2&gt;/dev/null | awk \"/^[^ \\\\t]/{smatch=\\$0; next }/port:[ \\\\t]*${1}/{print smatch, \\$0}{next}\"\n</code></pre>\n<pre><code class=\"language-Shell\">for p in `ls /proc`; do args=$(pargs $p | grep $p:) &amp;&amp; printf \"$args \\n $(pfiles $p | grep port:)\" ; done | less\n</code></pre>\n<pre><code class=\"language-Shell\">find /proc/*/fd/ | xargs grep -sl port:\n</code></pre>\n\n<h4 id=\"solaris-find-port-usage\">Solaris find port usage.</h4>\n<pre><code class=\"language-Shell\">ps -ef| awk '{print $2}'| xargs -I '{}' sh -c 'echo examining process {}; pfiles {}| grep &lt;PortToFind&gt;'\n</code></pre>\n\n<h4 id=\"list-all-users-cron-jobs\">List all users cron jobs</h4>\n<pre><code class=\"language-Shell\">for user in `getent passwd | awk -F':' '{ print $1}'`; do crontab -u $user -l; done\n</code></pre>\n\n<h4 id=\"list-all-varlog-files-used-my-active-processes\">List all /var/log files used my active processes.</h4>\n<pre><code class=\"language-Shell\">cd /proc; for pid in `find * -maxdepth 1 -type d -name \"fd\" -prune`; do ls -l /proc/$pid/. | grep /var/log &amp;&amp; echo $pid\" -------------Above this line--------------\" ; done;\n</code></pre>\n\n<h4 id=\"list-file-created-near-the-same-time\">List file created near the same time.</h4>\n<pre><code class=\"language-Shell\">find -type f -cnewer &lt;FileToCompare&gt; ! -newerct &lt;OneDayLater&gt; -ls\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs", "networking", "users", "filesystem", "enumeration" ], "next": { "title": "Auditctl", "categories": [ ], "previous": { "title": "general", "categories": [ "Unix", "Survey", "Enumeration" ], "previous": null, "url": "/commands/Unix%20Survey%20Helper.html", "collection": "commands", "content": "<h4 id=\"directories-leading-to-filename\">directories leading to FileName.</h4>\n<pre><code class=\"language-Shell\">namei -l &lt;/Full/Path/To/The/file&gt;\n</code></pre>\n\n<h4 id=\"ssh-logging-from-linux\">SSH logging from linux</h4>\n<pre><code class=\"language-Shell\">ssh &lt;IpAddress&gt; -u &lt;UserName&gt; | tee &gt;(while read line; do echo \"`date +'[%H:%M:%S]'` $line\"; done &gt;logfile)\n</code></pre>\n\n<h4 id=\"get-all-user-login-times\">get all user login times.</h4>\n<pre><code class=\"language-Shell\">for name in `getent passwd | awk '{split($0,a,\":\"); print(a[1])}'`; do last $name &gt;&gt; /tmp/logins.txt; done\n</code></pre>\n\n<h4 id=\"writes-to-the-master-boot-record-on-the-boot-device\">Writes to the Master Boot Record on the boot device.</h4>\n<pre><code class=\"language-Shell\">echo -n L | dd of=/boot/grub/stage1 bs=1 seek=&lt;OFFSET&gt; conv=notrunc\n</code></pre>\n\n<h4 id=\"compare-boot-directory-files-to-the-mbr\">Compare Boot directory files to the MBR.</h4>\n<pre><code class=\"language-Shell\">dd if=/dev/sda bs=512 count=1 | diff - /boot/grub/stage&lt;StageNumber&gt;\n</code></pre>\n\n<h4 id=\"get-all-user-login-shells\">get all user login shells</h4>\n<pre><code class=\"language-Shell\">getent passwd | awk -F':' '{ print($1\" - \"$7) }'\n</code></pre>\n\n<h4 id=\"display-all-processes-cwd-and-_-environments-good-for-find-an-executables-actual-running-directory-kinda-buggy-but-still-works\">display all processes cwd and _ environments. Good for find an executables actual running directory. (kinda buggy but still works)</h4>\n<pre><code class=\"language-Shell\">for i in $(find /proc -maxdepth 1 -type d); do echo \"$i # `ls -a $i/cwd` # $(cat $i/environ | awk '{ split($0,a,\"=\"); print(a[15]); }')\"; done | grep '# /'\n</code></pre>\n\n<h4 id=\"solaris-get-process-to-port-translation\">Solaris get process to port translation.</h4>\n<pre><code class=\"language-Shell\">pfiles `ls /proc` 2&gt;/dev/null | awk \"/^[^ \\\\t]/{smatch=\\$0; next }/port:[ \\\\t]*${1}/{print smatch, \\$0}{next}\"\n</code></pre>\n<pre><code class=\"language-Shell\">for p in `ls /proc`; do args=$(pargs $p | grep $p:) &amp;&amp; printf \"$args \\n $(pfiles $p | grep port:)\" ; done | less\n</code></pre>\n<pre><code class=\"language-Shell\">find /proc/*/fd/ | xargs grep -sl port:\n</code></pre>\n\n<h4 id=\"solaris-find-port-usage\">Solaris find port usage.</h4>\n<pre><code class=\"language-Shell\">ps -ef| awk '{print $2}'| xargs -I '{}' sh -c 'echo examining process {}; pfiles {}| grep &lt;PortToFind&gt;'\n</code></pre>\n\n<h4 id=\"list-all-users-cron-jobs\">List all users cron jobs</h4>\n<pre><code class=\"language-Shell\">for user in `getent passwd | awk -F':' '{ print $1}'`; do crontab -u $user -l; done\n</code></pre>\n\n<h4 id=\"list-all-varlog-files-used-my-active-processes\">List all /var/log files used my active processes.</h4>\n<pre><code class=\"language-Shell\">cd /proc; for pid in `find * -maxdepth 1 -type d -name \"fd\" -prune`; do ls -l /proc/$pid/. | grep /var/log &amp;&amp; echo $pid\" -------------Above this line--------------\" ; done;\n</code></pre>\n\n<h4 id=\"list-file-created-near-the-same-time\">List file created near the same time.</h4>\n<pre><code class=\"language-Shell\">find -type f -cnewer &lt;FileToCompare&gt; ! -newerct &lt;OneDayLater&gt; -ls\n</code></pre>\n", "id": "/commands/Unix Survey Helper", "output": "<h4 id=\"directories-leading-to-filename\">directories leading to FileName.</h4>\n<pre><code class=\"language-Shell\">namei -l &lt;/Full/Path/To/The/file&gt;\n</code></pre>\n\n<h4 id=\"ssh-logging-from-linux\">SSH logging from linux</h4>\n<pre><code class=\"language-Shell\">ssh &lt;IpAddress&gt; -u &lt;UserName&gt; | tee &gt;(while read line; do echo \"`date +'[%H:%M:%S]'` $line\"; done &gt;logfile)\n</code></pre>\n\n<h4 id=\"get-all-user-login-times\">get all user login times.</h4>\n<pre><code class=\"language-Shell\">for name in `getent passwd | awk '{split($0,a,\":\"); print(a[1])}'`; do last $name &gt;&gt; /tmp/logins.txt; done\n</code></pre>\n\n<h4 id=\"writes-to-the-master-boot-record-on-the-boot-device\">Writes to the Master Boot Record on the boot device.</h4>\n<pre><code class=\"language-Shell\">echo -n L | dd of=/boot/grub/stage1 bs=1 seek=&lt;OFFSET&gt; conv=notrunc\n</code></pre>\n\n<h4 id=\"compare-boot-directory-files-to-the-mbr\">Compare Boot directory files to the MBR.</h4>\n<pre><code class=\"language-Shell\">dd if=/dev/sda bs=512 count=1 | diff - /boot/grub/stage&lt;StageNumber&gt;\n</code></pre>\n\n<h4 id=\"get-all-user-login-shells\">get all user login shells</h4>\n<pre><code class=\"language-Shell\">getent passwd | awk -F':' '{ print($1\" - \"$7) }'\n</code></pre>\n\n<h4 id=\"display-all-processes-cwd-and-_-environments-good-for-find-an-executables-actual-running-directory-kinda-buggy-but-still-works\">display all processes cwd and _ environments. Good for find an executables actual running directory. (kinda buggy but still works)</h4>\n<pre><code class=\"language-Shell\">for i in $(find /proc -maxdepth 1 -type d); do echo \"$i # `ls -a $i/cwd` # $(cat $i/environ | awk '{ split($0,a,\"=\"); print(a[15]); }')\"; done | grep '# /'\n</code></pre>\n\n<h4 id=\"solaris-get-process-to-port-translation\">Solaris get process to port translation.</h4>\n<pre><code class=\"language-Shell\">pfiles `ls /proc` 2&gt;/dev/null | awk \"/^[^ \\\\t]/{smatch=\\$0; next }/port:[ \\\\t]*${1}/{print smatch, \\$0}{next}\"\n</code></pre>\n<pre><code class=\"language-Shell\">for p in `ls /proc`; do args=$(pargs $p | grep $p:) &amp;&amp; printf \"$args \\n $(pfiles $p | grep port:)\" ; done | less\n</code></pre>\n<pre><code class=\"language-Shell\">find /proc/*/fd/ | xargs grep -sl port:\n</code></pre>\n\n<h4 id=\"solaris-find-port-usage\">Solaris find port usage.</h4>\n<pre><code class=\"language-Shell\">ps -ef| awk '{print $2}'| xargs -I '{}' sh -c 'echo examining process {}; pfiles {}| grep &lt;PortToFind&gt;'\n</code></pre>\n\n<h4 id=\"list-all-users-cron-jobs\">List all users cron jobs</h4>\n<pre><code class=\"language-Shell\">for user in `getent passwd | awk -F':' '{ print $1}'`; do crontab -u $user -l; done\n</code></pre>\n\n<h4 id=\"list-all-varlog-files-used-my-active-processes\">List all /var/log files used my active processes.</h4>\n<pre><code class=\"language-Shell\">cd /proc; for pid in `find * -maxdepth 1 -type d -name \"fd\" -prune`; do ls -l /proc/$pid/. | grep /var/log &amp;&amp; echo $pid\" -------------Above this line--------------\" ; done;\n</code></pre>\n\n<h4 id=\"list-file-created-near-the-same-time\">List file created near the same time.</h4>\n<pre><code class=\"language-Shell\">find -type f -cnewer &lt;FileToCompare&gt; ! -newerct &lt;OneDayLater&gt; -ls\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs", "networking", "users", "filesystem", "enumeration" ], "next": { "title": "Auditctl", "categories": [ ], "url": "/commands/auditctl.html", "collection": "commands", "id": "/commands/auditctl", "date": "2021-09-29 15:24:26 -0500", "tags": [ ], "relative_path": "_commands/auditctl.md", "path": "_commands/auditctl.md", "draft": false, "layout": "page", "slug": "auditctl", "ext": ".md" }, "relative_path": "_commands/Unix Survey Helper.md", "path": "_commands/Unix Survey Helper.md", "excerpt": "<h4 id=\"directories-leading-to-filename\">directories leading to FileName.</h4>\n<pre><code class=\"language-Shell\">namei -l &lt;/Full/Path/To/The/file&gt;\n</code></pre>\n", "draft": false, "updated": "2021-09-27", "slug": "Unix Survey Helper", "ext": ".md" }, "url": "/commands/auditctl.html", "collection": "commands", "content": "<h3 id=\"auditctl\">auditctl</h3>\n\n<pre><code class=\"language-Shell\">// Display audit policy rules\nauditctl -l\n</code></pre>\n", "id": "/commands/auditctl", "output": "<!DOCTYPE html>\n<html lang=\"en\">\n\t<head><head>\r\n\t<meta charset=\"utf-8\" />\r\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\" />\r\n\t<title>Goober.dev</title><script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js\"></script><script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js\"></script><script type=\"text/javascript\" src=\"https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js\"></script><script type=\"text/javascript\" src=\"assets/js/nav.js\"></script><link rel=\"stylesheet\" href=\"https://use.fontawesome.com/releases/v5.6.3/css/all.css\" /><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Fredoka+One\" /><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\" /><link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css\" /><link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/base16/dracula.min.css\" /><link rel=\"stylesheet\" href=\"assets/css/main.css\" /></head>\r\n</head>\n\t<body>\n\t\t<nav class=\"w-full mb-4 bg-indigo-900 md:bg-transparent\">\r\n\t<!-- Website Logo -->\r\n\t<a href=\"#\" class=\"absolute w-12 h-12 left-2 top-2\">\r\n\t\t<img src=\"assets/images/logo3.svg\" alt=\"Logo\" class=\"h-auto\" />\r\n\t</a>\r\n\t<div class=\"p-2 mx-auto\">\r\n\t\t<div class=\"flex justify-between h-12 min-w-100\">\r\n\t\t\t<div class=\"flex items-center justify-center mx-auto\">\r\n\t\t\t\t<!-- Primary Navbar items -->\r\n\t\t\t\t<div class=\"items-center justify-center hidden space-x-7 md:flex font-fred\"><a href=\"/\"> Home </a>\r\n\t\t\t\t\t<img class=\"fab fa-dev\" /><a href=\"/cmds\"> Cmds </a>\r\n\t\t\t\t\t<img class=\"fas fa-terminal\" /><a href=\"/posts\"> Posts </a>\r\n\t\t\t\t\t<img class=\"far fa-newspaper\" /><a href=\"/about.html\"> About </a>\r\n\t\t\t\t\t<img class=\"fas fa-user-astronaut\" /><a href=\"/contact.html\"> Contact </a>\r\n\t\t\t\t\t<img class=\"far fa-comment-alt\" /></div>\r\n\t\t\t</div>\r\n\t\t\t<!-- Secondary Navbar items -->\r\n\t\t\t<div class=\"items-center hidden space-x-3 md:flex\"></div>\r\n\t\t\t<!-- Mobile menu button -->\r\n\t\t\t<div class=\"flex items-center md:hidden\">\r\n\t\t\t\t<button class=\"mx-4 mobile-btn\">\r\n\t\t\t\t\t<i class=\"text-2xl mobile-menu-btn fas fa-bars\"></i>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<!-- mobile menu -->\r\n\t<div class=\"hidden pb-2 md:hidden mobile-menu\">\r\n\t\t<ul class=\"mr-1 space-y-2\"><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/\"\r\n\t\t\t\t\t>Home<i class=\"ml-4 mr-5 fab fa-dev\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/cmds\"\r\n\t\t\t\t\t>Cmds<i class=\"ml-4 mr-5 fas fa-terminal\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/posts\"\r\n\t\t\t\t\t>Posts<i class=\"ml-4 mr-5 far fa-newspaper\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/about.html\"\r\n\t\t\t\t\t>About<i class=\"ml-4 mr-5 fas fa-user-astronaut\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/contact.html\"\r\n\t\t\t\t\t>Contact<i class=\"ml-4 mr-5 far fa-comment-alt\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li></ul>\r\n\t</div>\r\n</nav>\r\n <article class=\"post\">\n\t<header class=\"post-header\">\n\t\t<h1 class=\"post-title\">Auditctl</h1>\n\t</header>\n\n\t<h3 id=\"auditctl\">auditctl</h3>\n\n<pre class=\"terminal\"><div class=\"terminal-bar\">\n\t\t<div class=\"close\"></div>\n\t\t<div class=\"max\"></div>\n\t\t<div class=\"min\"></div>\n\t</div><code class=\"language-Shell\">// Display audit policy rules\nauditctl -l\n</code></pre>\n\n</article>\n<footer class=\"footer\">\r\n\t<ul class=\"p-4 list-none\">\r\n\t\t<li>\r\n\t\t\t<a href=\"https://github.com/GooberFromHell\"\r\n\t\t\t\t><i class=\"mr-3 fab fa-github\"></i>GooberFromHell</a\r\n\t\t\t>\r\n\t\t</li>\r\n\t</ul>\r\n\r\n\t<script type=\"text/javascript\">\r\n\t\thljs.highlightAll()\r\n\t</script>\r\n</footer>\r\n\n</body>\n</html>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ ], "next": { "title": "ausearch", "categories": [ "Auditing" ], "previous": { "title": "Auditctl", "categories": [ ], "url": "/commands/auditctl.html", "collection": "commands", "id": "/commands/auditctl", "date": "2021-09-29 15:24:26 -0500", "tags": [ ], "relative_path": "_commands/auditctl.md", "path": "_commands/auditctl.md", "draft": false, "layout": "page", "slug": "auditctl", "ext": ".md" }, "url": "/commands/ausearch.html", "collection": "commands", "content": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "id": "/commands/ausearch", "output": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "next": { "title": "firewall-cmd", "categories": [ "Auditing", "Firewall", "IPTables" ], "url": "/commands/firewall-cmd.html", "collection": "commands", "id": "/commands/firewall-cmd", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "security", "firewall" ], "relative_path": "_commands/firewall-cmd.md", "path": "_commands/firewall-cmd.md", "draft": false, "updated": "2021-09-27", "slug": "firewall-cmd", "ext": ".md" }, "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "excerpt": "<h3 id=\"ausearch\">ausearch</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" }, "relative_path": "_commands/auditctl.md", "path": "_commands/auditctl.md", "excerpt": "<h3 id=\"auditctl\">auditctl</h3>\n", "draft": false, "layout": "page", "slug": "auditctl", "ext": ".md" }, "relative_path": "_commands/Unix Survey Helper.md", "path": "_commands/Unix Survey Helper.md", "excerpt": "<h4 id=\"directories-leading-to-filename\">directories leading to FileName.</h4>\n<pre><code class=\"language-Shell\">namei -l &lt;/Full/Path/To/The/file&gt;\n</code></pre>\n", "draft": false, "updated": "2021-09-27", "slug": "Unix Survey Helper", "ext": ".md" } { "title": "Auditctl", "categories": [ ], "previous": { "title": "general", "categories": [ "Unix", "Survey", "Enumeration" ], "previous": null, "url": "/commands/Unix%20Survey%20Helper.html", "collection": "commands", "content": "<h4 id=\"directories-leading-to-filename\">directories leading to FileName.</h4>\n<pre><code class=\"language-Shell\">namei -l &lt;/Full/Path/To/The/file&gt;\n</code></pre>\n\n<h4 id=\"ssh-logging-from-linux\">SSH logging from linux</h4>\n<pre><code class=\"language-Shell\">ssh &lt;IpAddress&gt; -u &lt;UserName&gt; | tee &gt;(while read line; do echo \"`date +'[%H:%M:%S]'` $line\"; done &gt;logfile)\n</code></pre>\n\n<h4 id=\"get-all-user-login-times\">get all user login times.</h4>\n<pre><code class=\"language-Shell\">for name in `getent passwd | awk '{split($0,a,\":\"); print(a[1])}'`; do last $name &gt;&gt; /tmp/logins.txt; done\n</code></pre>\n\n<h4 id=\"writes-to-the-master-boot-record-on-the-boot-device\">Writes to the Master Boot Record on the boot device.</h4>\n<pre><code class=\"language-Shell\">echo -n L | dd of=/boot/grub/stage1 bs=1 seek=&lt;OFFSET&gt; conv=notrunc\n</code></pre>\n\n<h4 id=\"compare-boot-directory-files-to-the-mbr\">Compare Boot directory files to the MBR.</h4>\n<pre><code class=\"language-Shell\">dd if=/dev/sda bs=512 count=1 | diff - /boot/grub/stage&lt;StageNumber&gt;\n</code></pre>\n\n<h4 id=\"get-all-user-login-shells\">get all user login shells</h4>\n<pre><code class=\"language-Shell\">getent passwd | awk -F':' '{ print($1\" - \"$7) }'\n</code></pre>\n\n<h4 id=\"display-all-processes-cwd-and-_-environments-good-for-find-an-executables-actual-running-directory-kinda-buggy-but-still-works\">display all processes cwd and _ environments. Good for find an executables actual running directory. (kinda buggy but still works)</h4>\n<pre><code class=\"language-Shell\">for i in $(find /proc -maxdepth 1 -type d); do echo \"$i # `ls -a $i/cwd` # $(cat $i/environ | awk '{ split($0,a,\"=\"); print(a[15]); }')\"; done | grep '# /'\n</code></pre>\n\n<h4 id=\"solaris-get-process-to-port-translation\">Solaris get process to port translation.</h4>\n<pre><code class=\"language-Shell\">pfiles `ls /proc` 2&gt;/dev/null | awk \"/^[^ \\\\t]/{smatch=\\$0; next }/port:[ \\\\t]*${1}/{print smatch, \\$0}{next}\"\n</code></pre>\n<pre><code class=\"language-Shell\">for p in `ls /proc`; do args=$(pargs $p | grep $p:) &amp;&amp; printf \"$args \\n $(pfiles $p | grep port:)\" ; done | less\n</code></pre>\n<pre><code class=\"language-Shell\">find /proc/*/fd/ | xargs grep -sl port:\n</code></pre>\n\n<h4 id=\"solaris-find-port-usage\">Solaris find port usage.</h4>\n<pre><code class=\"language-Shell\">ps -ef| awk '{print $2}'| xargs -I '{}' sh -c 'echo examining process {}; pfiles {}| grep &lt;PortToFind&gt;'\n</code></pre>\n\n<h4 id=\"list-all-users-cron-jobs\">List all users cron jobs</h4>\n<pre><code class=\"language-Shell\">for user in `getent passwd | awk -F':' '{ print $1}'`; do crontab -u $user -l; done\n</code></pre>\n\n<h4 id=\"list-all-varlog-files-used-my-active-processes\">List all /var/log files used my active processes.</h4>\n<pre><code class=\"language-Shell\">cd /proc; for pid in `find * -maxdepth 1 -type d -name \"fd\" -prune`; do ls -l /proc/$pid/. | grep /var/log &amp;&amp; echo $pid\" -------------Above this line--------------\" ; done;\n</code></pre>\n\n<h4 id=\"list-file-created-near-the-same-time\">List file created near the same time.</h4>\n<pre><code class=\"language-Shell\">find -type f -cnewer &lt;FileToCompare&gt; ! -newerct &lt;OneDayLater&gt; -ls\n</code></pre>\n", "id": "/commands/Unix Survey Helper", "output": "<h4 id=\"directories-leading-to-filename\">directories leading to FileName.</h4>\n<pre><code class=\"language-Shell\">namei -l &lt;/Full/Path/To/The/file&gt;\n</code></pre>\n\n<h4 id=\"ssh-logging-from-linux\">SSH logging from linux</h4>\n<pre><code class=\"language-Shell\">ssh &lt;IpAddress&gt; -u &lt;UserName&gt; | tee &gt;(while read line; do echo \"`date +'[%H:%M:%S]'` $line\"; done &gt;logfile)\n</code></pre>\n\n<h4 id=\"get-all-user-login-times\">get all user login times.</h4>\n<pre><code class=\"language-Shell\">for name in `getent passwd | awk '{split($0,a,\":\"); print(a[1])}'`; do last $name &gt;&gt; /tmp/logins.txt; done\n</code></pre>\n\n<h4 id=\"writes-to-the-master-boot-record-on-the-boot-device\">Writes to the Master Boot Record on the boot device.</h4>\n<pre><code class=\"language-Shell\">echo -n L | dd of=/boot/grub/stage1 bs=1 seek=&lt;OFFSET&gt; conv=notrunc\n</code></pre>\n\n<h4 id=\"compare-boot-directory-files-to-the-mbr\">Compare Boot directory files to the MBR.</h4>\n<pre><code class=\"language-Shell\">dd if=/dev/sda bs=512 count=1 | diff - /boot/grub/stage&lt;StageNumber&gt;\n</code></pre>\n\n<h4 id=\"get-all-user-login-shells\">get all user login shells</h4>\n<pre><code class=\"language-Shell\">getent passwd | awk -F':' '{ print($1\" - \"$7) }'\n</code></pre>\n\n<h4 id=\"display-all-processes-cwd-and-_-environments-good-for-find-an-executables-actual-running-directory-kinda-buggy-but-still-works\">display all processes cwd and _ environments. Good for find an executables actual running directory. (kinda buggy but still works)</h4>\n<pre><code class=\"language-Shell\">for i in $(find /proc -maxdepth 1 -type d); do echo \"$i # `ls -a $i/cwd` # $(cat $i/environ | awk '{ split($0,a,\"=\"); print(a[15]); }')\"; done | grep '# /'\n</code></pre>\n\n<h4 id=\"solaris-get-process-to-port-translation\">Solaris get process to port translation.</h4>\n<pre><code class=\"language-Shell\">pfiles `ls /proc` 2&gt;/dev/null | awk \"/^[^ \\\\t]/{smatch=\\$0; next }/port:[ \\\\t]*${1}/{print smatch, \\$0}{next}\"\n</code></pre>\n<pre><code class=\"language-Shell\">for p in `ls /proc`; do args=$(pargs $p | grep $p:) &amp;&amp; printf \"$args \\n $(pfiles $p | grep port:)\" ; done | less\n</code></pre>\n<pre><code class=\"language-Shell\">find /proc/*/fd/ | xargs grep -sl port:\n</code></pre>\n\n<h4 id=\"solaris-find-port-usage\">Solaris find port usage.</h4>\n<pre><code class=\"language-Shell\">ps -ef| awk '{print $2}'| xargs -I '{}' sh -c 'echo examining process {}; pfiles {}| grep &lt;PortToFind&gt;'\n</code></pre>\n\n<h4 id=\"list-all-users-cron-jobs\">List all users cron jobs</h4>\n<pre><code class=\"language-Shell\">for user in `getent passwd | awk -F':' '{ print $1}'`; do crontab -u $user -l; done\n</code></pre>\n\n<h4 id=\"list-all-varlog-files-used-my-active-processes\">List all /var/log files used my active processes.</h4>\n<pre><code class=\"language-Shell\">cd /proc; for pid in `find * -maxdepth 1 -type d -name \"fd\" -prune`; do ls -l /proc/$pid/. | grep /var/log &amp;&amp; echo $pid\" -------------Above this line--------------\" ; done;\n</code></pre>\n\n<h4 id=\"list-file-created-near-the-same-time\">List file created near the same time.</h4>\n<pre><code class=\"language-Shell\">find -type f -cnewer &lt;FileToCompare&gt; ! -newerct &lt;OneDayLater&gt; -ls\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs", "networking", "users", "filesystem", "enumeration" ], "next": { "title": "Auditctl", "categories": [ ], "previous": { "title": "general", "categories": [ "Unix", "Survey", "Enumeration" ], "url": "/commands/Unix%20Survey%20Helper.html", "collection": "commands", "id": "/commands/Unix Survey Helper", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs", "networking", "users", "filesystem", "enumeration" ], "relative_path": "_commands/Unix Survey Helper.md", "path": "_commands/Unix Survey Helper.md", "draft": false, "updated": "2021-09-27", "slug": "Unix Survey Helper", "ext": ".md" }, "url": "/commands/auditctl.html", "collection": "commands", "content": "<h3 id=\"auditctl\">auditctl</h3>\n\n<pre><code class=\"language-Shell\">// Display audit policy rules\nauditctl -l\n</code></pre>\n", "id": "/commands/auditctl", "output": "<!DOCTYPE html>\n<html lang=\"en\">\n\t<head><head>\r\n\t<meta charset=\"utf-8\" />\r\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\" />\r\n\t<title>Goober.dev</title><script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js\"></script><script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js\"></script><script type=\"text/javascript\" src=\"https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js\"></script><script type=\"text/javascript\" src=\"assets/js/nav.js\"></script><link rel=\"stylesheet\" href=\"https://use.fontawesome.com/releases/v5.6.3/css/all.css\" /><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Fredoka+One\" /><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\" /><link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css\" /><link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/base16/dracula.min.css\" /><link rel=\"stylesheet\" href=\"assets/css/main.css\" /></head>\r\n</head>\n\t<body>\n\t\t<nav class=\"w-full mb-4 bg-indigo-900 md:bg-transparent\">\r\n\t<!-- Website Logo -->\r\n\t<a href=\"#\" class=\"absolute w-12 h-12 left-2 top-2\">\r\n\t\t<img src=\"assets/images/logo3.svg\" alt=\"Logo\" class=\"h-auto\" />\r\n\t</a>\r\n\t<div class=\"p-2 mx-auto\">\r\n\t\t<div class=\"flex justify-between h-12 min-w-100\">\r\n\t\t\t<div class=\"flex items-center justify-center mx-auto\">\r\n\t\t\t\t<!-- Primary Navbar items -->\r\n\t\t\t\t<div class=\"items-center justify-center hidden space-x-7 md:flex font-fred\"><a href=\"/\"> Home </a>\r\n\t\t\t\t\t<img class=\"fab fa-dev\" /><a href=\"/cmds\"> Cmds </a>\r\n\t\t\t\t\t<img class=\"fas fa-terminal\" /><a href=\"/posts\"> Posts </a>\r\n\t\t\t\t\t<img class=\"far fa-newspaper\" /><a href=\"/about.html\"> About </a>\r\n\t\t\t\t\t<img class=\"fas fa-user-astronaut\" /><a href=\"/contact.html\"> Contact </a>\r\n\t\t\t\t\t<img class=\"far fa-comment-alt\" /></div>\r\n\t\t\t</div>\r\n\t\t\t<!-- Secondary Navbar items -->\r\n\t\t\t<div class=\"items-center hidden space-x-3 md:flex\"></div>\r\n\t\t\t<!-- Mobile menu button -->\r\n\t\t\t<div class=\"flex items-center md:hidden\">\r\n\t\t\t\t<button class=\"mx-4 mobile-btn\">\r\n\t\t\t\t\t<i class=\"text-2xl mobile-menu-btn fas fa-bars\"></i>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<!-- mobile menu -->\r\n\t<div class=\"hidden pb-2 md:hidden mobile-menu\">\r\n\t\t<ul class=\"mr-1 space-y-2\"><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/\"\r\n\t\t\t\t\t>Home<i class=\"ml-4 mr-5 fab fa-dev\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/cmds\"\r\n\t\t\t\t\t>Cmds<i class=\"ml-4 mr-5 fas fa-terminal\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/posts\"\r\n\t\t\t\t\t>Posts<i class=\"ml-4 mr-5 far fa-newspaper\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/about.html\"\r\n\t\t\t\t\t>About<i class=\"ml-4 mr-5 fas fa-user-astronaut\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/contact.html\"\r\n\t\t\t\t\t>Contact<i class=\"ml-4 mr-5 far fa-comment-alt\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li></ul>\r\n\t</div>\r\n</nav>\r\n <article class=\"post\">\n\t<header class=\"post-header\">\n\t\t<h1 class=\"post-title\">Auditctl</h1>\n\t</header>\n\n\t<h3 id=\"auditctl\">auditctl</h3>\n\n<pre class=\"terminal\"><div class=\"terminal-bar\">\n\t\t<div class=\"close\"></div>\n\t\t<div class=\"max\"></div>\n\t\t<div class=\"min\"></div>\n\t</div><code class=\"language-Shell\">// Display audit policy rules\nauditctl -l\n</code></pre>\n\n</article>\n<footer class=\"footer\">\r\n\t<ul class=\"p-4 list-none\">\r\n\t\t<li>\r\n\t\t\t<a href=\"https://github.com/GooberFromHell\"\r\n\t\t\t\t><i class=\"mr-3 fab fa-github\"></i>GooberFromHell</a\r\n\t\t\t>\r\n\t\t</li>\r\n\t</ul>\r\n\r\n\t<script type=\"text/javascript\">\r\n\t\thljs.highlightAll()\r\n\t</script>\r\n</footer>\r\n\n</body>\n</html>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ ], "next": { "title": "ausearch", "categories": [ "Auditing" ], "url": "/commands/ausearch.html", "collection": "commands", "id": "/commands/ausearch", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" }, "relative_path": "_commands/auditctl.md", "path": "_commands/auditctl.md", "excerpt": "<h3 id=\"auditctl\">auditctl</h3>\n", "draft": false, "layout": "page", "slug": "auditctl", "ext": ".md" }, "relative_path": "_commands/Unix Survey Helper.md", "path": "_commands/Unix Survey Helper.md", "excerpt": "<h4 id=\"directories-leading-to-filename\">directories leading to FileName.</h4>\n<pre><code class=\"language-Shell\">namei -l &lt;/Full/Path/To/The/file&gt;\n</code></pre>\n", "draft": false, "updated": "2021-09-27", "slug": "Unix Survey Helper", "ext": ".md" }, "url": "/commands/auditctl.html", "collection": "commands", "content": "<h3 id=\"auditctl\">auditctl</h3>\n\n<pre><code class=\"language-Shell\">// Display audit policy rules\nauditctl -l\n</code></pre>\n", "id": "/commands/auditctl", "output": "<!DOCTYPE html>\n<html lang=\"en\">\n\t<head><head>\r\n\t<meta charset=\"utf-8\" />\r\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\" />\r\n\t<title>Goober.dev</title><script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js\"></script><script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js\"></script><script type=\"text/javascript\" src=\"https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js\"></script><script type=\"text/javascript\" src=\"assets/js/nav.js\"></script><link rel=\"stylesheet\" href=\"https://use.fontawesome.com/releases/v5.6.3/css/all.css\" /><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Fredoka+One\" /><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\" /><link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css\" /><link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/base16/dracula.min.css\" /><link rel=\"stylesheet\" href=\"assets/css/main.css\" /></head>\r\n</head>\n\t<body>\n\t\t<nav class=\"w-full mb-4 bg-indigo-900 md:bg-transparent\">\r\n\t<!-- Website Logo -->\r\n\t<a href=\"#\" class=\"absolute w-12 h-12 left-2 top-2\">\r\n\t\t<img src=\"assets/images/logo3.svg\" alt=\"Logo\" class=\"h-auto\" />\r\n\t</a>\r\n\t<div class=\"p-2 mx-auto\">\r\n\t\t<div class=\"flex justify-between h-12 min-w-100\">\r\n\t\t\t<div class=\"flex items-center justify-center mx-auto\">\r\n\t\t\t\t<!-- Primary Navbar items -->\r\n\t\t\t\t<div class=\"items-center justify-center hidden space-x-7 md:flex font-fred\"><a href=\"/\"> Home </a>\r\n\t\t\t\t\t<img class=\"fab fa-dev\" /><a href=\"/cmds\"> Cmds </a>\r\n\t\t\t\t\t<img class=\"fas fa-terminal\" /><a href=\"/posts\"> Posts </a>\r\n\t\t\t\t\t<img class=\"far fa-newspaper\" /><a href=\"/about.html\"> About </a>\r\n\t\t\t\t\t<img class=\"fas fa-user-astronaut\" /><a href=\"/contact.html\"> Contact </a>\r\n\t\t\t\t\t<img class=\"far fa-comment-alt\" /></div>\r\n\t\t\t</div>\r\n\t\t\t<!-- Secondary Navbar items -->\r\n\t\t\t<div class=\"items-center hidden space-x-3 md:flex\"></div>\r\n\t\t\t<!-- Mobile menu button -->\r\n\t\t\t<div class=\"flex items-center md:hidden\">\r\n\t\t\t\t<button class=\"mx-4 mobile-btn\">\r\n\t\t\t\t\t<i class=\"text-2xl mobile-menu-btn fas fa-bars\"></i>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<!-- mobile menu -->\r\n\t<div class=\"hidden pb-2 md:hidden mobile-menu\">\r\n\t\t<ul class=\"mr-1 space-y-2\"><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/\"\r\n\t\t\t\t\t>Home<i class=\"ml-4 mr-5 fab fa-dev\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/cmds\"\r\n\t\t\t\t\t>Cmds<i class=\"ml-4 mr-5 fas fa-terminal\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/posts\"\r\n\t\t\t\t\t>Posts<i class=\"ml-4 mr-5 far fa-newspaper\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/about.html\"\r\n\t\t\t\t\t>About<i class=\"ml-4 mr-5 fas fa-user-astronaut\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/contact.html\"\r\n\t\t\t\t\t>Contact<i class=\"ml-4 mr-5 far fa-comment-alt\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li></ul>\r\n\t</div>\r\n</nav>\r\n <article class=\"post\">\n\t<header class=\"post-header\">\n\t\t<h1 class=\"post-title\">Auditctl</h1>\n\t</header>\n\n\t<h3 id=\"auditctl\">auditctl</h3>\n\n<pre class=\"terminal\"><div class=\"terminal-bar\">\n\t\t<div class=\"close\"></div>\n\t\t<div class=\"max\"></div>\n\t\t<div class=\"min\"></div>\n\t</div><code class=\"language-Shell\">// Display audit policy rules\nauditctl -l\n</code></pre>\n\n</article>\n<footer class=\"footer\">\r\n\t<ul class=\"p-4 list-none\">\r\n\t\t<li>\r\n\t\t\t<a href=\"https://github.com/GooberFromHell\"\r\n\t\t\t\t><i class=\"mr-3 fab fa-github\"></i>GooberFromHell</a\r\n\t\t\t>\r\n\t\t</li>\r\n\t</ul>\r\n\r\n\t<script type=\"text/javascript\">\r\n\t\thljs.highlightAll()\r\n\t</script>\r\n</footer>\r\n\n</body>\n</html>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ ], "next": { "title": "ausearch", "categories": [ "Auditing" ], "previous": { "title": "Auditctl", "categories": [ ], "previous": { "title": "general", "categories": [ "Unix", "Survey", "Enumeration" ], "url": "/commands/Unix%20Survey%20Helper.html", "collection": "commands", "id": "/commands/Unix Survey Helper", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs", "networking", "users", "filesystem", "enumeration" ], "relative_path": "_commands/Unix Survey Helper.md", "path": "_commands/Unix Survey Helper.md", "draft": false, "updated": "2021-09-27", "slug": "Unix Survey Helper", "ext": ".md" }, "url": "/commands/auditctl.html", "collection": "commands", "content": "<h3 id=\"auditctl\">auditctl</h3>\n\n<pre><code class=\"language-Shell\">// Display audit policy rules\nauditctl -l\n</code></pre>\n", "id": "/commands/auditctl", "output": "<!DOCTYPE html>\n<html lang=\"en\">\n\t<head><head>\r\n\t<meta charset=\"utf-8\" />\r\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\" />\r\n\t<title>Goober.dev</title><script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js\"></script><script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js\"></script><script type=\"text/javascript\" src=\"https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js\"></script><script type=\"text/javascript\" src=\"assets/js/nav.js\"></script><link rel=\"stylesheet\" href=\"https://use.fontawesome.com/releases/v5.6.3/css/all.css\" /><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Fredoka+One\" /><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\" /><link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css\" /><link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/base16/dracula.min.css\" /><link rel=\"stylesheet\" href=\"assets/css/main.css\" /></head>\r\n</head>\n\t<body>\n\t\t<nav class=\"w-full mb-4 bg-indigo-900 md:bg-transparent\">\r\n\t<!-- Website Logo -->\r\n\t<a href=\"#\" class=\"absolute w-12 h-12 left-2 top-2\">\r\n\t\t<img src=\"assets/images/logo3.svg\" alt=\"Logo\" class=\"h-auto\" />\r\n\t</a>\r\n\t<div class=\"p-2 mx-auto\">\r\n\t\t<div class=\"flex justify-between h-12 min-w-100\">\r\n\t\t\t<div class=\"flex items-center justify-center mx-auto\">\r\n\t\t\t\t<!-- Primary Navbar items -->\r\n\t\t\t\t<div class=\"items-center justify-center hidden space-x-7 md:flex font-fred\"><a href=\"/\"> Home </a>\r\n\t\t\t\t\t<img class=\"fab fa-dev\" /><a href=\"/cmds\"> Cmds </a>\r\n\t\t\t\t\t<img class=\"fas fa-terminal\" /><a href=\"/posts\"> Posts </a>\r\n\t\t\t\t\t<img class=\"far fa-newspaper\" /><a href=\"/about.html\"> About </a>\r\n\t\t\t\t\t<img class=\"fas fa-user-astronaut\" /><a href=\"/contact.html\"> Contact </a>\r\n\t\t\t\t\t<img class=\"far fa-comment-alt\" /></div>\r\n\t\t\t</div>\r\n\t\t\t<!-- Secondary Navbar items -->\r\n\t\t\t<div class=\"items-center hidden space-x-3 md:flex\"></div>\r\n\t\t\t<!-- Mobile menu button -->\r\n\t\t\t<div class=\"flex items-center md:hidden\">\r\n\t\t\t\t<button class=\"mx-4 mobile-btn\">\r\n\t\t\t\t\t<i class=\"text-2xl mobile-menu-btn fas fa-bars\"></i>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<!-- mobile menu -->\r\n\t<div class=\"hidden pb-2 md:hidden mobile-menu\">\r\n\t\t<ul class=\"mr-1 space-y-2\"><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/\"\r\n\t\t\t\t\t>Home<i class=\"ml-4 mr-5 fab fa-dev\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/cmds\"\r\n\t\t\t\t\t>Cmds<i class=\"ml-4 mr-5 fas fa-terminal\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/posts\"\r\n\t\t\t\t\t>Posts<i class=\"ml-4 mr-5 far fa-newspaper\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/about.html\"\r\n\t\t\t\t\t>About<i class=\"ml-4 mr-5 fas fa-user-astronaut\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/contact.html\"\r\n\t\t\t\t\t>Contact<i class=\"ml-4 mr-5 far fa-comment-alt\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li></ul>\r\n\t</div>\r\n</nav>\r\n <article class=\"post\">\n\t<header class=\"post-header\">\n\t\t<h1 class=\"post-title\">Auditctl</h1>\n\t</header>\n\n\t<h3 id=\"auditctl\">auditctl</h3>\n\n<pre class=\"terminal\"><div class=\"terminal-bar\">\n\t\t<div class=\"close\"></div>\n\t\t<div class=\"max\"></div>\n\t\t<div class=\"min\"></div>\n\t</div><code class=\"language-Shell\">// Display audit policy rules\nauditctl -l\n</code></pre>\n\n</article>\n<footer class=\"footer\">\r\n\t<ul class=\"p-4 list-none\">\r\n\t\t<li>\r\n\t\t\t<a href=\"https://github.com/GooberFromHell\"\r\n\t\t\t\t><i class=\"mr-3 fab fa-github\"></i>GooberFromHell</a\r\n\t\t\t>\r\n\t\t</li>\r\n\t</ul>\r\n\r\n\t<script type=\"text/javascript\">\r\n\t\thljs.highlightAll()\r\n\t</script>\r\n</footer>\r\n\n</body>\n</html>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ ], "next": { "title": "ausearch", "categories": [ "Auditing" ], "url": "/commands/ausearch.html", "collection": "commands", "id": "/commands/ausearch", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" }, "relative_path": "_commands/auditctl.md", "path": "_commands/auditctl.md", "excerpt": "<h3 id=\"auditctl\">auditctl</h3>\n", "draft": false, "layout": "page", "slug": "auditctl", "ext": ".md" }, "url": "/commands/ausearch.html", "collection": "commands", "content": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "id": "/commands/ausearch", "output": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "next": { "title": "firewall-cmd", "categories": [ "Auditing", "Firewall", "IPTables" ], "previous": { "title": "ausearch", "categories": [ "Auditing" ], "url": "/commands/ausearch.html", "collection": "commands", "id": "/commands/ausearch", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" }, "url": "/commands/firewall-cmd.html", "collection": "commands", "content": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n\n<p>!!! note Notes</p>\n\n<h4 id=\"firewalld-daemon\">Firewalld Daemon</h4>\n\n<ul>\n <li>Enabled by default on systemd</li>\n <li>Applicaitons and services can all their own rules and exceptions to the firewall.</li>\n <li>The daemon enables the separation of the runtime and permanent configurations.</li>\n <li>The Daemon allows for dynamic amanagement of the firewall and provides support fo the firewall zones.</li>\n</ul>\n\n<h4 id=\"rule-matching-order\">Rule Matching Order</h4>\n\n<ul>\n <li>The Source IP address is checked first.</li>\n <li>The Interface is check if there is no matching rule for the source IP.</li>\n <li>If neither the source or reciving interface match, the default zine is used.</li>\n <li><strong>DENY</strong> takes precidence over <strong>ALLOW</strong>.</li>\n</ul>\n\n<h4 id=\"saving-configuration\">Saving Configuration</h4>\n\n<ul>\n <li>Running configuration is lost if the service is stoped or rebooted before saving.</li>\n <li>Permanent configuration is read at start or at daemon reload.</li>\n</ul>\n\n<h4 id=\"firewall-cmd-1\">Firewall-cmd</h4>\n\n<ul>\n <li>Supports tab completion.</li>\n</ul>\n\n<p>!!!</p>\n\n<hr />\n\n<h4 id=\"zones\">Zones</h4>\n\n<ul>\n <li>trusted</li>\n <li>home</li>\n <li>internal</li>\n <li>work</li>\n <li>public</li>\n <li>external</li>\n <li>dmz</li>\n <li>block</li>\n <li>drop</li>\n</ul>\n\n<hr />\n\n<h4 id=\"configuration-files\">Configuration Files</h4>\n\n<table>\n <thead>\n <tr>\n <th style=\"text-align: left\">File</th>\n <th style=\"text-align: left\">Purpose</th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td style=\"text-align: left\">/usr/lib/firewalld/</td>\n <td style=\"text-align: left\">Defaukt configuration files for firewalld</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/</td>\n <td style=\"text-align: left\">- User defined and system firewalld configurations<br />- If there are no user configurations there may not be any xml files.<br />- If there are user configurations, the file will be names firewalld.conf</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/firewalld.conf</td>\n <td style=\"text-align: left\">User defined configurations. (Mihgt not exist)</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/services</td>\n <td style=\"text-align: left\">User defined services and rules.</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/zones</td>\n <td style=\"text-align: left\">User defined Zones and rules.</td>\n </tr>\n </tbody>\n</table>\n\n<hr />\n\n<h4 id=\"syntax\">Syntax</h4>\n\n<h5 id=\"rich-syntax\">Rich Syntax</h5>\n\n<p>Resource: <strong><a href=\"(https://fedoraproject.org/wiki/Features/FirewalldRichLanguage#Handle_rich_rules_with_the_command_line_client)\">Rich Syntax Arguments</a></strong></p>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'\n</code></pre>\n\n<pre><code class=\"language-shell\">firewall-cmd --add-rich-rule='rule family=ipv4 source address=192.168.1.0/24 service name=ssh log prefix=\"SSH Access\" level=\"notice\" accept'\n</code></pre>\n\n<h5 id=\"direct-syntax\">Direct Syntax</h5>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE\n</code></pre>\n\n<hr />\n\n<h4 id=\"commands\">Commands</h4>\n\n<p>!!! error IMPORTANT!\nAlways add <strong>permanent</strong> to save changes to the firewalld <br />configuration, after Making changes.\n!!!</p>\n\n<h4 id=\"view-rules\">View rules</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --list-all-zones\n</code></pre>\n\n<h3 id=\"list-direct-rules\">List direct rules</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --direct --get-all-rules\n</code></pre>\n\n<h4 id=\"reload-firewalld-with-zero-down-time\">Reload firewalld with zero down-time.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --reload-\n</code></pre>\n\n<h3 id=\"block-outbound-traffic\">Block Outbound traffic</h3>\n<pre><code class=\"language-Shell\">// Can add --dport, --sport\nfirewall-cmd --direct --add-rule ipv4 filter OUTPUT 0 -p tcp -m tcp -d &lt;IPAddress&gt; -j DROP\n</code></pre>\n\n<h4 id=\"set-default-zone\">Set Default Zone</h4>\n\n<pre><code class=\"language-Shell\">firewal-cmd -set-default-zone=&lt;Zone&gt;\n</code></pre>\n\n<h4 id=\"route-all-traffic-from-a-network-into-a-zone\">Route all Traffic from a network into a zone.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-source=&lt;NetWorkOrHost&gt;/&lt;24,etc..&gt;\n</code></pre>\n\n<h4 id=\"route-specific-service-into-a-zone\">Route specific service into a zone</h4>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-service=&lt;ServiceByName&gt;\n</code></pre>\n\n<h3 id=\"remove-a-sevice-from-default-zone\">Remove a sevice from DEFAULT zone</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --remove-service=&lt;ServiceName&gt;\n</code></pre>\n\n", "id": "/commands/firewall-cmd", "output": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n\n<p>!!! note Notes</p>\n\n<h4 id=\"firewalld-daemon\">Firewalld Daemon</h4>\n\n<ul>\n <li>Enabled by default on systemd</li>\n <li>Applicaitons and services can all their own rules and exceptions to the firewall.</li>\n <li>The daemon enables the separation of the runtime and permanent configurations.</li>\n <li>The Daemon allows for dynamic amanagement of the firewall and provides support fo the firewall zones.</li>\n</ul>\n\n<h4 id=\"rule-matching-order\">Rule Matching Order</h4>\n\n<ul>\n <li>The Source IP address is checked first.</li>\n <li>The Interface is check if there is no matching rule for the source IP.</li>\n <li>If neither the source or reciving interface match, the default zine is used.</li>\n <li><strong>DENY</strong> takes precidence over <strong>ALLOW</strong>.</li>\n</ul>\n\n<h4 id=\"saving-configuration\">Saving Configuration</h4>\n\n<ul>\n <li>Running configuration is lost if the service is stoped or rebooted before saving.</li>\n <li>Permanent configuration is read at start or at daemon reload.</li>\n</ul>\n\n<h4 id=\"firewall-cmd-1\">Firewall-cmd</h4>\n\n<ul>\n <li>Supports tab completion.</li>\n</ul>\n\n<p>!!!</p>\n\n<hr />\n\n<h4 id=\"zones\">Zones</h4>\n\n<ul>\n <li>trusted</li>\n <li>home</li>\n <li>internal</li>\n <li>work</li>\n <li>public</li>\n <li>external</li>\n <li>dmz</li>\n <li>block</li>\n <li>drop</li>\n</ul>\n\n<hr />\n\n<h4 id=\"configuration-files\">Configuration Files</h4>\n\n<table>\n <thead>\n <tr>\n <th style=\"text-align: left\">File</th>\n <th style=\"text-align: left\">Purpose</th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td style=\"text-align: left\">/usr/lib/firewalld/</td>\n <td style=\"text-align: left\">Defaukt configuration files for firewalld</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/</td>\n <td style=\"text-align: left\">- User defined and system firewalld configurations<br />- If there are no user configurations there may not be any xml files.<br />- If there are user configurations, the file will be names firewalld.conf</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/firewalld.conf</td>\n <td style=\"text-align: left\">User defined configurations. (Mihgt not exist)</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/services</td>\n <td style=\"text-align: left\">User defined services and rules.</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/zones</td>\n <td style=\"text-align: left\">User defined Zones and rules.</td>\n </tr>\n </tbody>\n</table>\n\n<hr />\n\n<h4 id=\"syntax\">Syntax</h4>\n\n<h5 id=\"rich-syntax\">Rich Syntax</h5>\n\n<p>Resource: <strong><a href=\"(https://fedoraproject.org/wiki/Features/FirewalldRichLanguage#Handle_rich_rules_with_the_command_line_client)\">Rich Syntax Arguments</a></strong></p>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'\n</code></pre>\n\n<pre><code class=\"language-shell\">firewall-cmd --add-rich-rule='rule family=ipv4 source address=192.168.1.0/24 service name=ssh log prefix=\"SSH Access\" level=\"notice\" accept'\n</code></pre>\n\n<h5 id=\"direct-syntax\">Direct Syntax</h5>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE\n</code></pre>\n\n<hr />\n\n<h4 id=\"commands\">Commands</h4>\n\n<p>!!! error IMPORTANT!\nAlways add <strong>permanent</strong> to save changes to the firewalld <br />configuration, after Making changes.\n!!!</p>\n\n<h4 id=\"view-rules\">View rules</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --list-all-zones\n</code></pre>\n\n<h3 id=\"list-direct-rules\">List direct rules</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --direct --get-all-rules\n</code></pre>\n\n<h4 id=\"reload-firewalld-with-zero-down-time\">Reload firewalld with zero down-time.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --reload-\n</code></pre>\n\n<h3 id=\"block-outbound-traffic\">Block Outbound traffic</h3>\n<pre><code class=\"language-Shell\">// Can add --dport, --sport\nfirewall-cmd --direct --add-rule ipv4 filter OUTPUT 0 -p tcp -m tcp -d &lt;IPAddress&gt; -j DROP\n</code></pre>\n\n<h4 id=\"set-default-zone\">Set Default Zone</h4>\n\n<pre><code class=\"language-Shell\">firewal-cmd -set-default-zone=&lt;Zone&gt;\n</code></pre>\n\n<h4 id=\"route-all-traffic-from-a-network-into-a-zone\">Route all Traffic from a network into a zone.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-source=&lt;NetWorkOrHost&gt;/&lt;24,etc..&gt;\n</code></pre>\n\n<h4 id=\"route-specific-service-into-a-zone\">Route specific service into a zone</h4>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-service=&lt;ServiceByName&gt;\n</code></pre>\n\n<h3 id=\"remove-a-sevice-from-default-zone\">Remove a sevice from DEFAULT zone</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --remove-service=&lt;ServiceName&gt;\n</code></pre>\n\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "security", "firewall" ], "next": { "title": "route", "categories": [ "Networking" ], "url": "/commands/route.html", "collection": "commands", "id": "/commands/route", "date": "2021-09-29 15:24:26 -0500", "tags": [ "networking", "unix", "smf" ], "relative_path": "_commands/route.md", "path": "_commands/route.md", "draft": false, "updated": "2021-09-22", "slug": "route", "ext": ".md" }, "relative_path": "_commands/firewall-cmd.md", "path": "_commands/firewall-cmd.md", "excerpt": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "firewall-cmd", "ext": ".md" }, "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "excerpt": "<h3 id=\"ausearch\">ausearch</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" }, "relative_path": "_commands/auditctl.md", "path": "_commands/auditctl.md", "excerpt": "<h3 id=\"auditctl\">auditctl</h3>\n", "draft": false, "layout": "page", "slug": "auditctl", "ext": ".md" } { "title": "ausearch", "categories": [ "Auditing" ], "previous": { "title": "Auditctl", "categories": [ ], "previous": { "title": "general", "categories": [ "Unix", "Survey", "Enumeration" ], "previous": null, "url": "/commands/Unix%20Survey%20Helper.html", "collection": "commands", "content": "<h4 id=\"directories-leading-to-filename\">directories leading to FileName.</h4>\n<pre><code class=\"language-Shell\">namei -l &lt;/Full/Path/To/The/file&gt;\n</code></pre>\n\n<h4 id=\"ssh-logging-from-linux\">SSH logging from linux</h4>\n<pre><code class=\"language-Shell\">ssh &lt;IpAddress&gt; -u &lt;UserName&gt; | tee &gt;(while read line; do echo \"`date +'[%H:%M:%S]'` $line\"; done &gt;logfile)\n</code></pre>\n\n<h4 id=\"get-all-user-login-times\">get all user login times.</h4>\n<pre><code class=\"language-Shell\">for name in `getent passwd | awk '{split($0,a,\":\"); print(a[1])}'`; do last $name &gt;&gt; /tmp/logins.txt; done\n</code></pre>\n\n<h4 id=\"writes-to-the-master-boot-record-on-the-boot-device\">Writes to the Master Boot Record on the boot device.</h4>\n<pre><code class=\"language-Shell\">echo -n L | dd of=/boot/grub/stage1 bs=1 seek=&lt;OFFSET&gt; conv=notrunc\n</code></pre>\n\n<h4 id=\"compare-boot-directory-files-to-the-mbr\">Compare Boot directory files to the MBR.</h4>\n<pre><code class=\"language-Shell\">dd if=/dev/sda bs=512 count=1 | diff - /boot/grub/stage&lt;StageNumber&gt;\n</code></pre>\n\n<h4 id=\"get-all-user-login-shells\">get all user login shells</h4>\n<pre><code class=\"language-Shell\">getent passwd | awk -F':' '{ print($1\" - \"$7) }'\n</code></pre>\n\n<h4 id=\"display-all-processes-cwd-and-_-environments-good-for-find-an-executables-actual-running-directory-kinda-buggy-but-still-works\">display all processes cwd and _ environments. Good for find an executables actual running directory. (kinda buggy but still works)</h4>\n<pre><code class=\"language-Shell\">for i in $(find /proc -maxdepth 1 -type d); do echo \"$i # `ls -a $i/cwd` # $(cat $i/environ | awk '{ split($0,a,\"=\"); print(a[15]); }')\"; done | grep '# /'\n</code></pre>\n\n<h4 id=\"solaris-get-process-to-port-translation\">Solaris get process to port translation.</h4>\n<pre><code class=\"language-Shell\">pfiles `ls /proc` 2&gt;/dev/null | awk \"/^[^ \\\\t]/{smatch=\\$0; next }/port:[ \\\\t]*${1}/{print smatch, \\$0}{next}\"\n</code></pre>\n<pre><code class=\"language-Shell\">for p in `ls /proc`; do args=$(pargs $p | grep $p:) &amp;&amp; printf \"$args \\n $(pfiles $p | grep port:)\" ; done | less\n</code></pre>\n<pre><code class=\"language-Shell\">find /proc/*/fd/ | xargs grep -sl port:\n</code></pre>\n\n<h4 id=\"solaris-find-port-usage\">Solaris find port usage.</h4>\n<pre><code class=\"language-Shell\">ps -ef| awk '{print $2}'| xargs -I '{}' sh -c 'echo examining process {}; pfiles {}| grep &lt;PortToFind&gt;'\n</code></pre>\n\n<h4 id=\"list-all-users-cron-jobs\">List all users cron jobs</h4>\n<pre><code class=\"language-Shell\">for user in `getent passwd | awk -F':' '{ print $1}'`; do crontab -u $user -l; done\n</code></pre>\n\n<h4 id=\"list-all-varlog-files-used-my-active-processes\">List all /var/log files used my active processes.</h4>\n<pre><code class=\"language-Shell\">cd /proc; for pid in `find * -maxdepth 1 -type d -name \"fd\" -prune`; do ls -l /proc/$pid/. | grep /var/log &amp;&amp; echo $pid\" -------------Above this line--------------\" ; done;\n</code></pre>\n\n<h4 id=\"list-file-created-near-the-same-time\">List file created near the same time.</h4>\n<pre><code class=\"language-Shell\">find -type f -cnewer &lt;FileToCompare&gt; ! -newerct &lt;OneDayLater&gt; -ls\n</code></pre>\n", "id": "/commands/Unix Survey Helper", "output": "<h4 id=\"directories-leading-to-filename\">directories leading to FileName.</h4>\n<pre><code class=\"language-Shell\">namei -l &lt;/Full/Path/To/The/file&gt;\n</code></pre>\n\n<h4 id=\"ssh-logging-from-linux\">SSH logging from linux</h4>\n<pre><code class=\"language-Shell\">ssh &lt;IpAddress&gt; -u &lt;UserName&gt; | tee &gt;(while read line; do echo \"`date +'[%H:%M:%S]'` $line\"; done &gt;logfile)\n</code></pre>\n\n<h4 id=\"get-all-user-login-times\">get all user login times.</h4>\n<pre><code class=\"language-Shell\">for name in `getent passwd | awk '{split($0,a,\":\"); print(a[1])}'`; do last $name &gt;&gt; /tmp/logins.txt; done\n</code></pre>\n\n<h4 id=\"writes-to-the-master-boot-record-on-the-boot-device\">Writes to the Master Boot Record on the boot device.</h4>\n<pre><code class=\"language-Shell\">echo -n L | dd of=/boot/grub/stage1 bs=1 seek=&lt;OFFSET&gt; conv=notrunc\n</code></pre>\n\n<h4 id=\"compare-boot-directory-files-to-the-mbr\">Compare Boot directory files to the MBR.</h4>\n<pre><code class=\"language-Shell\">dd if=/dev/sda bs=512 count=1 | diff - /boot/grub/stage&lt;StageNumber&gt;\n</code></pre>\n\n<h4 id=\"get-all-user-login-shells\">get all user login shells</h4>\n<pre><code class=\"language-Shell\">getent passwd | awk -F':' '{ print($1\" - \"$7) }'\n</code></pre>\n\n<h4 id=\"display-all-processes-cwd-and-_-environments-good-for-find-an-executables-actual-running-directory-kinda-buggy-but-still-works\">display all processes cwd and _ environments. Good for find an executables actual running directory. (kinda buggy but still works)</h4>\n<pre><code class=\"language-Shell\">for i in $(find /proc -maxdepth 1 -type d); do echo \"$i # `ls -a $i/cwd` # $(cat $i/environ | awk '{ split($0,a,\"=\"); print(a[15]); }')\"; done | grep '# /'\n</code></pre>\n\n<h4 id=\"solaris-get-process-to-port-translation\">Solaris get process to port translation.</h4>\n<pre><code class=\"language-Shell\">pfiles `ls /proc` 2&gt;/dev/null | awk \"/^[^ \\\\t]/{smatch=\\$0; next }/port:[ \\\\t]*${1}/{print smatch, \\$0}{next}\"\n</code></pre>\n<pre><code class=\"language-Shell\">for p in `ls /proc`; do args=$(pargs $p | grep $p:) &amp;&amp; printf \"$args \\n $(pfiles $p | grep port:)\" ; done | less\n</code></pre>\n<pre><code class=\"language-Shell\">find /proc/*/fd/ | xargs grep -sl port:\n</code></pre>\n\n<h4 id=\"solaris-find-port-usage\">Solaris find port usage.</h4>\n<pre><code class=\"language-Shell\">ps -ef| awk '{print $2}'| xargs -I '{}' sh -c 'echo examining process {}; pfiles {}| grep &lt;PortToFind&gt;'\n</code></pre>\n\n<h4 id=\"list-all-users-cron-jobs\">List all users cron jobs</h4>\n<pre><code class=\"language-Shell\">for user in `getent passwd | awk -F':' '{ print $1}'`; do crontab -u $user -l; done\n</code></pre>\n\n<h4 id=\"list-all-varlog-files-used-my-active-processes\">List all /var/log files used my active processes.</h4>\n<pre><code class=\"language-Shell\">cd /proc; for pid in `find * -maxdepth 1 -type d -name \"fd\" -prune`; do ls -l /proc/$pid/. | grep /var/log &amp;&amp; echo $pid\" -------------Above this line--------------\" ; done;\n</code></pre>\n\n<h4 id=\"list-file-created-near-the-same-time\">List file created near the same time.</h4>\n<pre><code class=\"language-Shell\">find -type f -cnewer &lt;FileToCompare&gt; ! -newerct &lt;OneDayLater&gt; -ls\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs", "networking", "users", "filesystem", "enumeration" ], "next": { "title": "Auditctl", "categories": [ ], "url": "/commands/auditctl.html", "collection": "commands", "id": "/commands/auditctl", "date": "2021-09-29 15:24:26 -0500", "tags": [ ], "relative_path": "_commands/auditctl.md", "path": "_commands/auditctl.md", "draft": false, "layout": "page", "slug": "auditctl", "ext": ".md" }, "relative_path": "_commands/Unix Survey Helper.md", "path": "_commands/Unix Survey Helper.md", "excerpt": "<h4 id=\"directories-leading-to-filename\">directories leading to FileName.</h4>\n<pre><code class=\"language-Shell\">namei -l &lt;/Full/Path/To/The/file&gt;\n</code></pre>\n", "draft": false, "updated": "2021-09-27", "slug": "Unix Survey Helper", "ext": ".md" }, "url": "/commands/auditctl.html", "collection": "commands", "content": "<h3 id=\"auditctl\">auditctl</h3>\n\n<pre><code class=\"language-Shell\">// Display audit policy rules\nauditctl -l\n</code></pre>\n", "id": "/commands/auditctl", "output": "<!DOCTYPE html>\n<html lang=\"en\">\n\t<head><head>\r\n\t<meta charset=\"utf-8\" />\r\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\" />\r\n\t<title>Goober.dev</title><script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js\"></script><script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js\"></script><script type=\"text/javascript\" src=\"https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js\"></script><script type=\"text/javascript\" src=\"assets/js/nav.js\"></script><link rel=\"stylesheet\" href=\"https://use.fontawesome.com/releases/v5.6.3/css/all.css\" /><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Fredoka+One\" /><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\" /><link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css\" /><link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/base16/dracula.min.css\" /><link rel=\"stylesheet\" href=\"assets/css/main.css\" /></head>\r\n</head>\n\t<body>\n\t\t<nav class=\"w-full mb-4 bg-indigo-900 md:bg-transparent\">\r\n\t<!-- Website Logo -->\r\n\t<a href=\"#\" class=\"absolute w-12 h-12 left-2 top-2\">\r\n\t\t<img src=\"assets/images/logo3.svg\" alt=\"Logo\" class=\"h-auto\" />\r\n\t</a>\r\n\t<div class=\"p-2 mx-auto\">\r\n\t\t<div class=\"flex justify-between h-12 min-w-100\">\r\n\t\t\t<div class=\"flex items-center justify-center mx-auto\">\r\n\t\t\t\t<!-- Primary Navbar items -->\r\n\t\t\t\t<div class=\"items-center justify-center hidden space-x-7 md:flex font-fred\"><a href=\"/\"> Home </a>\r\n\t\t\t\t\t<img class=\"fab fa-dev\" /><a href=\"/cmds\"> Cmds </a>\r\n\t\t\t\t\t<img class=\"fas fa-terminal\" /><a href=\"/posts\"> Posts </a>\r\n\t\t\t\t\t<img class=\"far fa-newspaper\" /><a href=\"/about.html\"> About </a>\r\n\t\t\t\t\t<img class=\"fas fa-user-astronaut\" /><a href=\"/contact.html\"> Contact </a>\r\n\t\t\t\t\t<img class=\"far fa-comment-alt\" /></div>\r\n\t\t\t</div>\r\n\t\t\t<!-- Secondary Navbar items -->\r\n\t\t\t<div class=\"items-center hidden space-x-3 md:flex\"></div>\r\n\t\t\t<!-- Mobile menu button -->\r\n\t\t\t<div class=\"flex items-center md:hidden\">\r\n\t\t\t\t<button class=\"mx-4 mobile-btn\">\r\n\t\t\t\t\t<i class=\"text-2xl mobile-menu-btn fas fa-bars\"></i>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<!-- mobile menu -->\r\n\t<div class=\"hidden pb-2 md:hidden mobile-menu\">\r\n\t\t<ul class=\"mr-1 space-y-2\"><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/\"\r\n\t\t\t\t\t>Home<i class=\"ml-4 mr-5 fab fa-dev\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/cmds\"\r\n\t\t\t\t\t>Cmds<i class=\"ml-4 mr-5 fas fa-terminal\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/posts\"\r\n\t\t\t\t\t>Posts<i class=\"ml-4 mr-5 far fa-newspaper\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/about.html\"\r\n\t\t\t\t\t>About<i class=\"ml-4 mr-5 fas fa-user-astronaut\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/contact.html\"\r\n\t\t\t\t\t>Contact<i class=\"ml-4 mr-5 far fa-comment-alt\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li></ul>\r\n\t</div>\r\n</nav>\r\n <article class=\"post\">\n\t<header class=\"post-header\">\n\t\t<h1 class=\"post-title\">Auditctl</h1>\n\t</header>\n\n\t<h3 id=\"auditctl\">auditctl</h3>\n\n<pre class=\"terminal\"><div class=\"terminal-bar\">\n\t\t<div class=\"close\"></div>\n\t\t<div class=\"max\"></div>\n\t\t<div class=\"min\"></div>\n\t</div><code class=\"language-Shell\">// Display audit policy rules\nauditctl -l\n</code></pre>\n\n</article>\n<footer class=\"footer\">\r\n\t<ul class=\"p-4 list-none\">\r\n\t\t<li>\r\n\t\t\t<a href=\"https://github.com/GooberFromHell\"\r\n\t\t\t\t><i class=\"mr-3 fab fa-github\"></i>GooberFromHell</a\r\n\t\t\t>\r\n\t\t</li>\r\n\t</ul>\r\n\r\n\t<script type=\"text/javascript\">\r\n\t\thljs.highlightAll()\r\n\t</script>\r\n</footer>\r\n\n</body>\n</html>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ ], "next": { "title": "ausearch", "categories": [ "Auditing" ], "previous": { "title": "Auditctl", "categories": [ ], "url": "/commands/auditctl.html", "collection": "commands", "id": "/commands/auditctl", "date": "2021-09-29 15:24:26 -0500", "tags": [ ], "relative_path": "_commands/auditctl.md", "path": "_commands/auditctl.md", "draft": false, "layout": "page", "slug": "auditctl", "ext": ".md" }, "url": "/commands/ausearch.html", "collection": "commands", "content": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "id": "/commands/ausearch", "output": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "next": { "title": "firewall-cmd", "categories": [ "Auditing", "Firewall", "IPTables" ], "url": "/commands/firewall-cmd.html", "collection": "commands", "id": "/commands/firewall-cmd", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "security", "firewall" ], "relative_path": "_commands/firewall-cmd.md", "path": "_commands/firewall-cmd.md", "draft": false, "updated": "2021-09-27", "slug": "firewall-cmd", "ext": ".md" }, "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "excerpt": "<h3 id=\"ausearch\">ausearch</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" }, "relative_path": "_commands/auditctl.md", "path": "_commands/auditctl.md", "excerpt": "<h3 id=\"auditctl\">auditctl</h3>\n", "draft": false, "layout": "page", "slug": "auditctl", "ext": ".md" }, "url": "/commands/ausearch.html", "collection": "commands", "content": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "id": "/commands/ausearch", "output": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "next": { "title": "firewall-cmd", "categories": [ "Auditing", "Firewall", "IPTables" ], "previous": { "title": "ausearch", "categories": [ "Auditing" ], "previous": { "title": "Auditctl", "categories": [ ], "url": "/commands/auditctl.html", "collection": "commands", "id": "/commands/auditctl", "date": "2021-09-29 15:24:26 -0500", "tags": [ ], "relative_path": "_commands/auditctl.md", "path": "_commands/auditctl.md", "draft": false, "layout": "page", "slug": "auditctl", "ext": ".md" }, "url": "/commands/ausearch.html", "collection": "commands", "content": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "id": "/commands/ausearch", "output": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "next": { "title": "firewall-cmd", "categories": [ "Auditing", "Firewall", "IPTables" ], "url": "/commands/firewall-cmd.html", "collection": "commands", "id": "/commands/firewall-cmd", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "security", "firewall" ], "relative_path": "_commands/firewall-cmd.md", "path": "_commands/firewall-cmd.md", "draft": false, "updated": "2021-09-27", "slug": "firewall-cmd", "ext": ".md" }, "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "excerpt": "<h3 id=\"ausearch\">ausearch</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" }, "url": "/commands/firewall-cmd.html", "collection": "commands", "content": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n\n<p>!!! note Notes</p>\n\n<h4 id=\"firewalld-daemon\">Firewalld Daemon</h4>\n\n<ul>\n <li>Enabled by default on systemd</li>\n <li>Applicaitons and services can all their own rules and exceptions to the firewall.</li>\n <li>The daemon enables the separation of the runtime and permanent configurations.</li>\n <li>The Daemon allows for dynamic amanagement of the firewall and provides support fo the firewall zones.</li>\n</ul>\n\n<h4 id=\"rule-matching-order\">Rule Matching Order</h4>\n\n<ul>\n <li>The Source IP address is checked first.</li>\n <li>The Interface is check if there is no matching rule for the source IP.</li>\n <li>If neither the source or reciving interface match, the default zine is used.</li>\n <li><strong>DENY</strong> takes precidence over <strong>ALLOW</strong>.</li>\n</ul>\n\n<h4 id=\"saving-configuration\">Saving Configuration</h4>\n\n<ul>\n <li>Running configuration is lost if the service is stoped or rebooted before saving.</li>\n <li>Permanent configuration is read at start or at daemon reload.</li>\n</ul>\n\n<h4 id=\"firewall-cmd-1\">Firewall-cmd</h4>\n\n<ul>\n <li>Supports tab completion.</li>\n</ul>\n\n<p>!!!</p>\n\n<hr />\n\n<h4 id=\"zones\">Zones</h4>\n\n<ul>\n <li>trusted</li>\n <li>home</li>\n <li>internal</li>\n <li>work</li>\n <li>public</li>\n <li>external</li>\n <li>dmz</li>\n <li>block</li>\n <li>drop</li>\n</ul>\n\n<hr />\n\n<h4 id=\"configuration-files\">Configuration Files</h4>\n\n<table>\n <thead>\n <tr>\n <th style=\"text-align: left\">File</th>\n <th style=\"text-align: left\">Purpose</th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td style=\"text-align: left\">/usr/lib/firewalld/</td>\n <td style=\"text-align: left\">Defaukt configuration files for firewalld</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/</td>\n <td style=\"text-align: left\">- User defined and system firewalld configurations<br />- If there are no user configurations there may not be any xml files.<br />- If there are user configurations, the file will be names firewalld.conf</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/firewalld.conf</td>\n <td style=\"text-align: left\">User defined configurations. (Mihgt not exist)</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/services</td>\n <td style=\"text-align: left\">User defined services and rules.</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/zones</td>\n <td style=\"text-align: left\">User defined Zones and rules.</td>\n </tr>\n </tbody>\n</table>\n\n<hr />\n\n<h4 id=\"syntax\">Syntax</h4>\n\n<h5 id=\"rich-syntax\">Rich Syntax</h5>\n\n<p>Resource: <strong><a href=\"(https://fedoraproject.org/wiki/Features/FirewalldRichLanguage#Handle_rich_rules_with_the_command_line_client)\">Rich Syntax Arguments</a></strong></p>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'\n</code></pre>\n\n<pre><code class=\"language-shell\">firewall-cmd --add-rich-rule='rule family=ipv4 source address=192.168.1.0/24 service name=ssh log prefix=\"SSH Access\" level=\"notice\" accept'\n</code></pre>\n\n<h5 id=\"direct-syntax\">Direct Syntax</h5>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE\n</code></pre>\n\n<hr />\n\n<h4 id=\"commands\">Commands</h4>\n\n<p>!!! error IMPORTANT!\nAlways add <strong>permanent</strong> to save changes to the firewalld <br />configuration, after Making changes.\n!!!</p>\n\n<h4 id=\"view-rules\">View rules</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --list-all-zones\n</code></pre>\n\n<h3 id=\"list-direct-rules\">List direct rules</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --direct --get-all-rules\n</code></pre>\n\n<h4 id=\"reload-firewalld-with-zero-down-time\">Reload firewalld with zero down-time.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --reload-\n</code></pre>\n\n<h3 id=\"block-outbound-traffic\">Block Outbound traffic</h3>\n<pre><code class=\"language-Shell\">// Can add --dport, --sport\nfirewall-cmd --direct --add-rule ipv4 filter OUTPUT 0 -p tcp -m tcp -d &lt;IPAddress&gt; -j DROP\n</code></pre>\n\n<h4 id=\"set-default-zone\">Set Default Zone</h4>\n\n<pre><code class=\"language-Shell\">firewal-cmd -set-default-zone=&lt;Zone&gt;\n</code></pre>\n\n<h4 id=\"route-all-traffic-from-a-network-into-a-zone\">Route all Traffic from a network into a zone.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-source=&lt;NetWorkOrHost&gt;/&lt;24,etc..&gt;\n</code></pre>\n\n<h4 id=\"route-specific-service-into-a-zone\">Route specific service into a zone</h4>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-service=&lt;ServiceByName&gt;\n</code></pre>\n\n<h3 id=\"remove-a-sevice-from-default-zone\">Remove a sevice from DEFAULT zone</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --remove-service=&lt;ServiceName&gt;\n</code></pre>\n\n", "id": "/commands/firewall-cmd", "output": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n\n<p>!!! note Notes</p>\n\n<h4 id=\"firewalld-daemon\">Firewalld Daemon</h4>\n\n<ul>\n <li>Enabled by default on systemd</li>\n <li>Applicaitons and services can all their own rules and exceptions to the firewall.</li>\n <li>The daemon enables the separation of the runtime and permanent configurations.</li>\n <li>The Daemon allows for dynamic amanagement of the firewall and provides support fo the firewall zones.</li>\n</ul>\n\n<h4 id=\"rule-matching-order\">Rule Matching Order</h4>\n\n<ul>\n <li>The Source IP address is checked first.</li>\n <li>The Interface is check if there is no matching rule for the source IP.</li>\n <li>If neither the source or reciving interface match, the default zine is used.</li>\n <li><strong>DENY</strong> takes precidence over <strong>ALLOW</strong>.</li>\n</ul>\n\n<h4 id=\"saving-configuration\">Saving Configuration</h4>\n\n<ul>\n <li>Running configuration is lost if the service is stoped or rebooted before saving.</li>\n <li>Permanent configuration is read at start or at daemon reload.</li>\n</ul>\n\n<h4 id=\"firewall-cmd-1\">Firewall-cmd</h4>\n\n<ul>\n <li>Supports tab completion.</li>\n</ul>\n\n<p>!!!</p>\n\n<hr />\n\n<h4 id=\"zones\">Zones</h4>\n\n<ul>\n <li>trusted</li>\n <li>home</li>\n <li>internal</li>\n <li>work</li>\n <li>public</li>\n <li>external</li>\n <li>dmz</li>\n <li>block</li>\n <li>drop</li>\n</ul>\n\n<hr />\n\n<h4 id=\"configuration-files\">Configuration Files</h4>\n\n<table>\n <thead>\n <tr>\n <th style=\"text-align: left\">File</th>\n <th style=\"text-align: left\">Purpose</th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td style=\"text-align: left\">/usr/lib/firewalld/</td>\n <td style=\"text-align: left\">Defaukt configuration files for firewalld</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/</td>\n <td style=\"text-align: left\">- User defined and system firewalld configurations<br />- If there are no user configurations there may not be any xml files.<br />- If there are user configurations, the file will be names firewalld.conf</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/firewalld.conf</td>\n <td style=\"text-align: left\">User defined configurations. (Mihgt not exist)</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/services</td>\n <td style=\"text-align: left\">User defined services and rules.</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/zones</td>\n <td style=\"text-align: left\">User defined Zones and rules.</td>\n </tr>\n </tbody>\n</table>\n\n<hr />\n\n<h4 id=\"syntax\">Syntax</h4>\n\n<h5 id=\"rich-syntax\">Rich Syntax</h5>\n\n<p>Resource: <strong><a href=\"(https://fedoraproject.org/wiki/Features/FirewalldRichLanguage#Handle_rich_rules_with_the_command_line_client)\">Rich Syntax Arguments</a></strong></p>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'\n</code></pre>\n\n<pre><code class=\"language-shell\">firewall-cmd --add-rich-rule='rule family=ipv4 source address=192.168.1.0/24 service name=ssh log prefix=\"SSH Access\" level=\"notice\" accept'\n</code></pre>\n\n<h5 id=\"direct-syntax\">Direct Syntax</h5>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE\n</code></pre>\n\n<hr />\n\n<h4 id=\"commands\">Commands</h4>\n\n<p>!!! error IMPORTANT!\nAlways add <strong>permanent</strong> to save changes to the firewalld <br />configuration, after Making changes.\n!!!</p>\n\n<h4 id=\"view-rules\">View rules</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --list-all-zones\n</code></pre>\n\n<h3 id=\"list-direct-rules\">List direct rules</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --direct --get-all-rules\n</code></pre>\n\n<h4 id=\"reload-firewalld-with-zero-down-time\">Reload firewalld with zero down-time.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --reload-\n</code></pre>\n\n<h3 id=\"block-outbound-traffic\">Block Outbound traffic</h3>\n<pre><code class=\"language-Shell\">// Can add --dport, --sport\nfirewall-cmd --direct --add-rule ipv4 filter OUTPUT 0 -p tcp -m tcp -d &lt;IPAddress&gt; -j DROP\n</code></pre>\n\n<h4 id=\"set-default-zone\">Set Default Zone</h4>\n\n<pre><code class=\"language-Shell\">firewal-cmd -set-default-zone=&lt;Zone&gt;\n</code></pre>\n\n<h4 id=\"route-all-traffic-from-a-network-into-a-zone\">Route all Traffic from a network into a zone.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-source=&lt;NetWorkOrHost&gt;/&lt;24,etc..&gt;\n</code></pre>\n\n<h4 id=\"route-specific-service-into-a-zone\">Route specific service into a zone</h4>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-service=&lt;ServiceByName&gt;\n</code></pre>\n\n<h3 id=\"remove-a-sevice-from-default-zone\">Remove a sevice from DEFAULT zone</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --remove-service=&lt;ServiceName&gt;\n</code></pre>\n\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "security", "firewall" ], "next": { "title": "route", "categories": [ "Networking" ], "previous": { "title": "firewall-cmd", "categories": [ "Auditing", "Firewall", "IPTables" ], "url": "/commands/firewall-cmd.html", "collection": "commands", "id": "/commands/firewall-cmd", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "security", "firewall" ], "relative_path": "_commands/firewall-cmd.md", "path": "_commands/firewall-cmd.md", "draft": false, "updated": "2021-09-27", "slug": "firewall-cmd", "ext": ".md" }, "url": "/commands/route.html", "collection": "commands", "content": "<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Add route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route del default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt; gw &lt;Gateway&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route del -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;OldDefaultGatewayIP&gt;\n # Change default gateway.\nroute add default &lt;NewDefaultGatewayIP&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Add static route.\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Delete static route.\n</code></pre>\n", "id": "/commands/route", "output": "<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Add route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route del default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt; gw &lt;Gateway&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route del -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;OldDefaultGatewayIP&gt;\n # Change default gateway.\nroute add default &lt;NewDefaultGatewayIP&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Add static route.\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Delete static route.\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "networking", "unix", "smf" ], "next": null, "relative_path": "_commands/route.md", "path": "_commands/route.md", "excerpt": "<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n", "draft": false, "updated": "2021-09-22", "slug": "route", "ext": ".md" }, "relative_path": "_commands/firewall-cmd.md", "path": "_commands/firewall-cmd.md", "excerpt": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "firewall-cmd", "ext": ".md" }, "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "excerpt": "<h3 id=\"ausearch\">ausearch</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" } { "title": "firewall-cmd", "categories": [ "Auditing", "Firewall", "IPTables" ], "previous": { "title": "ausearch", "categories": [ "Auditing" ], "previous": { "title": "Auditctl", "categories": [ ], "previous": { "title": "general", "categories": [ "Unix", "Survey", "Enumeration" ], "url": "/commands/Unix%20Survey%20Helper.html", "collection": "commands", "id": "/commands/Unix Survey Helper", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs", "networking", "users", "filesystem", "enumeration" ], "relative_path": "_commands/Unix Survey Helper.md", "path": "_commands/Unix Survey Helper.md", "draft": false, "updated": "2021-09-27", "slug": "Unix Survey Helper", "ext": ".md" }, "url": "/commands/auditctl.html", "collection": "commands", "content": "<h3 id=\"auditctl\">auditctl</h3>\n\n<pre><code class=\"language-Shell\">// Display audit policy rules\nauditctl -l\n</code></pre>\n", "id": "/commands/auditctl", "output": "<!DOCTYPE html>\n<html lang=\"en\">\n\t<head><head>\r\n\t<meta charset=\"utf-8\" />\r\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\" />\r\n\t<title>Goober.dev</title><script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js\"></script><script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js\"></script><script type=\"text/javascript\" src=\"https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js\"></script><script type=\"text/javascript\" src=\"assets/js/nav.js\"></script><link rel=\"stylesheet\" href=\"https://use.fontawesome.com/releases/v5.6.3/css/all.css\" /><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Fredoka+One\" /><link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\" /><link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css\" /><link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/base16/dracula.min.css\" /><link rel=\"stylesheet\" href=\"assets/css/main.css\" /></head>\r\n</head>\n\t<body>\n\t\t<nav class=\"w-full mb-4 bg-indigo-900 md:bg-transparent\">\r\n\t<!-- Website Logo -->\r\n\t<a href=\"#\" class=\"absolute w-12 h-12 left-2 top-2\">\r\n\t\t<img src=\"assets/images/logo3.svg\" alt=\"Logo\" class=\"h-auto\" />\r\n\t</a>\r\n\t<div class=\"p-2 mx-auto\">\r\n\t\t<div class=\"flex justify-between h-12 min-w-100\">\r\n\t\t\t<div class=\"flex items-center justify-center mx-auto\">\r\n\t\t\t\t<!-- Primary Navbar items -->\r\n\t\t\t\t<div class=\"items-center justify-center hidden space-x-7 md:flex font-fred\"><a href=\"/\"> Home </a>\r\n\t\t\t\t\t<img class=\"fab fa-dev\" /><a href=\"/cmds\"> Cmds </a>\r\n\t\t\t\t\t<img class=\"fas fa-terminal\" /><a href=\"/posts\"> Posts </a>\r\n\t\t\t\t\t<img class=\"far fa-newspaper\" /><a href=\"/about.html\"> About </a>\r\n\t\t\t\t\t<img class=\"fas fa-user-astronaut\" /><a href=\"/contact.html\"> Contact </a>\r\n\t\t\t\t\t<img class=\"far fa-comment-alt\" /></div>\r\n\t\t\t</div>\r\n\t\t\t<!-- Secondary Navbar items -->\r\n\t\t\t<div class=\"items-center hidden space-x-3 md:flex\"></div>\r\n\t\t\t<!-- Mobile menu button -->\r\n\t\t\t<div class=\"flex items-center md:hidden\">\r\n\t\t\t\t<button class=\"mx-4 mobile-btn\">\r\n\t\t\t\t\t<i class=\"text-2xl mobile-menu-btn fas fa-bars\"></i>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<!-- mobile menu -->\r\n\t<div class=\"hidden pb-2 md:hidden mobile-menu\">\r\n\t\t<ul class=\"mr-1 space-y-2\"><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/\"\r\n\t\t\t\t\t>Home<i class=\"ml-4 mr-5 fab fa-dev\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/cmds\"\r\n\t\t\t\t\t>Cmds<i class=\"ml-4 mr-5 fas fa-terminal\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/posts\"\r\n\t\t\t\t\t>Posts<i class=\"ml-4 mr-5 far fa-newspaper\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/about.html\"\r\n\t\t\t\t\t>About<i class=\"ml-4 mr-5 fas fa-user-astronaut\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li><li class=\"text-right list-item\">\r\n\t\t\t\t<a class=\"items-end text-2xl font-fred\" href=\"/contact.html\"\r\n\t\t\t\t\t>Contact<i class=\"ml-4 mr-5 far fa-comment-alt\"></i\r\n\t\t\t\t></a>\r\n\t\t\t</li></ul>\r\n\t</div>\r\n</nav>\r\n <article class=\"post\">\n\t<header class=\"post-header\">\n\t\t<h1 class=\"post-title\">Auditctl</h1>\n\t</header>\n\n\t<h3 id=\"auditctl\">auditctl</h3>\n\n<pre class=\"terminal\"><div class=\"terminal-bar\">\n\t\t<div class=\"close\"></div>\n\t\t<div class=\"max\"></div>\n\t\t<div class=\"min\"></div>\n\t</div><code class=\"language-Shell\">// Display audit policy rules\nauditctl -l\n</code></pre>\n\n</article>\n<footer class=\"footer\">\r\n\t<ul class=\"p-4 list-none\">\r\n\t\t<li>\r\n\t\t\t<a href=\"https://github.com/GooberFromHell\"\r\n\t\t\t\t><i class=\"mr-3 fab fa-github\"></i>GooberFromHell</a\r\n\t\t\t>\r\n\t\t</li>\r\n\t</ul>\r\n\r\n\t<script type=\"text/javascript\">\r\n\t\thljs.highlightAll()\r\n\t</script>\r\n</footer>\r\n\n</body>\n</html>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ ], "next": { "title": "ausearch", "categories": [ "Auditing" ], "url": "/commands/ausearch.html", "collection": "commands", "id": "/commands/ausearch", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" }, "relative_path": "_commands/auditctl.md", "path": "_commands/auditctl.md", "excerpt": "<h3 id=\"auditctl\">auditctl</h3>\n", "draft": false, "layout": "page", "slug": "auditctl", "ext": ".md" }, "url": "/commands/ausearch.html", "collection": "commands", "content": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "id": "/commands/ausearch", "output": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "next": { "title": "firewall-cmd", "categories": [ "Auditing", "Firewall", "IPTables" ], "previous": { "title": "ausearch", "categories": [ "Auditing" ], "url": "/commands/ausearch.html", "collection": "commands", "id": "/commands/ausearch", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" }, "url": "/commands/firewall-cmd.html", "collection": "commands", "content": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n\n<p>!!! note Notes</p>\n\n<h4 id=\"firewalld-daemon\">Firewalld Daemon</h4>\n\n<ul>\n <li>Enabled by default on systemd</li>\n <li>Applicaitons and services can all their own rules and exceptions to the firewall.</li>\n <li>The daemon enables the separation of the runtime and permanent configurations.</li>\n <li>The Daemon allows for dynamic amanagement of the firewall and provides support fo the firewall zones.</li>\n</ul>\n\n<h4 id=\"rule-matching-order\">Rule Matching Order</h4>\n\n<ul>\n <li>The Source IP address is checked first.</li>\n <li>The Interface is check if there is no matching rule for the source IP.</li>\n <li>If neither the source or reciving interface match, the default zine is used.</li>\n <li><strong>DENY</strong> takes precidence over <strong>ALLOW</strong>.</li>\n</ul>\n\n<h4 id=\"saving-configuration\">Saving Configuration</h4>\n\n<ul>\n <li>Running configuration is lost if the service is stoped or rebooted before saving.</li>\n <li>Permanent configuration is read at start or at daemon reload.</li>\n</ul>\n\n<h4 id=\"firewall-cmd-1\">Firewall-cmd</h4>\n\n<ul>\n <li>Supports tab completion.</li>\n</ul>\n\n<p>!!!</p>\n\n<hr />\n\n<h4 id=\"zones\">Zones</h4>\n\n<ul>\n <li>trusted</li>\n <li>home</li>\n <li>internal</li>\n <li>work</li>\n <li>public</li>\n <li>external</li>\n <li>dmz</li>\n <li>block</li>\n <li>drop</li>\n</ul>\n\n<hr />\n\n<h4 id=\"configuration-files\">Configuration Files</h4>\n\n<table>\n <thead>\n <tr>\n <th style=\"text-align: left\">File</th>\n <th style=\"text-align: left\">Purpose</th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td style=\"text-align: left\">/usr/lib/firewalld/</td>\n <td style=\"text-align: left\">Defaukt configuration files for firewalld</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/</td>\n <td style=\"text-align: left\">- User defined and system firewalld configurations<br />- If there are no user configurations there may not be any xml files.<br />- If there are user configurations, the file will be names firewalld.conf</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/firewalld.conf</td>\n <td style=\"text-align: left\">User defined configurations. (Mihgt not exist)</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/services</td>\n <td style=\"text-align: left\">User defined services and rules.</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/zones</td>\n <td style=\"text-align: left\">User defined Zones and rules.</td>\n </tr>\n </tbody>\n</table>\n\n<hr />\n\n<h4 id=\"syntax\">Syntax</h4>\n\n<h5 id=\"rich-syntax\">Rich Syntax</h5>\n\n<p>Resource: <strong><a href=\"(https://fedoraproject.org/wiki/Features/FirewalldRichLanguage#Handle_rich_rules_with_the_command_line_client)\">Rich Syntax Arguments</a></strong></p>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'\n</code></pre>\n\n<pre><code class=\"language-shell\">firewall-cmd --add-rich-rule='rule family=ipv4 source address=192.168.1.0/24 service name=ssh log prefix=\"SSH Access\" level=\"notice\" accept'\n</code></pre>\n\n<h5 id=\"direct-syntax\">Direct Syntax</h5>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE\n</code></pre>\n\n<hr />\n\n<h4 id=\"commands\">Commands</h4>\n\n<p>!!! error IMPORTANT!\nAlways add <strong>permanent</strong> to save changes to the firewalld <br />configuration, after Making changes.\n!!!</p>\n\n<h4 id=\"view-rules\">View rules</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --list-all-zones\n</code></pre>\n\n<h3 id=\"list-direct-rules\">List direct rules</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --direct --get-all-rules\n</code></pre>\n\n<h4 id=\"reload-firewalld-with-zero-down-time\">Reload firewalld with zero down-time.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --reload-\n</code></pre>\n\n<h3 id=\"block-outbound-traffic\">Block Outbound traffic</h3>\n<pre><code class=\"language-Shell\">// Can add --dport, --sport\nfirewall-cmd --direct --add-rule ipv4 filter OUTPUT 0 -p tcp -m tcp -d &lt;IPAddress&gt; -j DROP\n</code></pre>\n\n<h4 id=\"set-default-zone\">Set Default Zone</h4>\n\n<pre><code class=\"language-Shell\">firewal-cmd -set-default-zone=&lt;Zone&gt;\n</code></pre>\n\n<h4 id=\"route-all-traffic-from-a-network-into-a-zone\">Route all Traffic from a network into a zone.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-source=&lt;NetWorkOrHost&gt;/&lt;24,etc..&gt;\n</code></pre>\n\n<h4 id=\"route-specific-service-into-a-zone\">Route specific service into a zone</h4>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-service=&lt;ServiceByName&gt;\n</code></pre>\n\n<h3 id=\"remove-a-sevice-from-default-zone\">Remove a sevice from DEFAULT zone</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --remove-service=&lt;ServiceName&gt;\n</code></pre>\n\n", "id": "/commands/firewall-cmd", "output": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n\n<p>!!! note Notes</p>\n\n<h4 id=\"firewalld-daemon\">Firewalld Daemon</h4>\n\n<ul>\n <li>Enabled by default on systemd</li>\n <li>Applicaitons and services can all their own rules and exceptions to the firewall.</li>\n <li>The daemon enables the separation of the runtime and permanent configurations.</li>\n <li>The Daemon allows for dynamic amanagement of the firewall and provides support fo the firewall zones.</li>\n</ul>\n\n<h4 id=\"rule-matching-order\">Rule Matching Order</h4>\n\n<ul>\n <li>The Source IP address is checked first.</li>\n <li>The Interface is check if there is no matching rule for the source IP.</li>\n <li>If neither the source or reciving interface match, the default zine is used.</li>\n <li><strong>DENY</strong> takes precidence over <strong>ALLOW</strong>.</li>\n</ul>\n\n<h4 id=\"saving-configuration\">Saving Configuration</h4>\n\n<ul>\n <li>Running configuration is lost if the service is stoped or rebooted before saving.</li>\n <li>Permanent configuration is read at start or at daemon reload.</li>\n</ul>\n\n<h4 id=\"firewall-cmd-1\">Firewall-cmd</h4>\n\n<ul>\n <li>Supports tab completion.</li>\n</ul>\n\n<p>!!!</p>\n\n<hr />\n\n<h4 id=\"zones\">Zones</h4>\n\n<ul>\n <li>trusted</li>\n <li>home</li>\n <li>internal</li>\n <li>work</li>\n <li>public</li>\n <li>external</li>\n <li>dmz</li>\n <li>block</li>\n <li>drop</li>\n</ul>\n\n<hr />\n\n<h4 id=\"configuration-files\">Configuration Files</h4>\n\n<table>\n <thead>\n <tr>\n <th style=\"text-align: left\">File</th>\n <th style=\"text-align: left\">Purpose</th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td style=\"text-align: left\">/usr/lib/firewalld/</td>\n <td style=\"text-align: left\">Defaukt configuration files for firewalld</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/</td>\n <td style=\"text-align: left\">- User defined and system firewalld configurations<br />- If there are no user configurations there may not be any xml files.<br />- If there are user configurations, the file will be names firewalld.conf</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/firewalld.conf</td>\n <td style=\"text-align: left\">User defined configurations. (Mihgt not exist)</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/services</td>\n <td style=\"text-align: left\">User defined services and rules.</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/zones</td>\n <td style=\"text-align: left\">User defined Zones and rules.</td>\n </tr>\n </tbody>\n</table>\n\n<hr />\n\n<h4 id=\"syntax\">Syntax</h4>\n\n<h5 id=\"rich-syntax\">Rich Syntax</h5>\n\n<p>Resource: <strong><a href=\"(https://fedoraproject.org/wiki/Features/FirewalldRichLanguage#Handle_rich_rules_with_the_command_line_client)\">Rich Syntax Arguments</a></strong></p>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'\n</code></pre>\n\n<pre><code class=\"language-shell\">firewall-cmd --add-rich-rule='rule family=ipv4 source address=192.168.1.0/24 service name=ssh log prefix=\"SSH Access\" level=\"notice\" accept'\n</code></pre>\n\n<h5 id=\"direct-syntax\">Direct Syntax</h5>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE\n</code></pre>\n\n<hr />\n\n<h4 id=\"commands\">Commands</h4>\n\n<p>!!! error IMPORTANT!\nAlways add <strong>permanent</strong> to save changes to the firewalld <br />configuration, after Making changes.\n!!!</p>\n\n<h4 id=\"view-rules\">View rules</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --list-all-zones\n</code></pre>\n\n<h3 id=\"list-direct-rules\">List direct rules</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --direct --get-all-rules\n</code></pre>\n\n<h4 id=\"reload-firewalld-with-zero-down-time\">Reload firewalld with zero down-time.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --reload-\n</code></pre>\n\n<h3 id=\"block-outbound-traffic\">Block Outbound traffic</h3>\n<pre><code class=\"language-Shell\">// Can add --dport, --sport\nfirewall-cmd --direct --add-rule ipv4 filter OUTPUT 0 -p tcp -m tcp -d &lt;IPAddress&gt; -j DROP\n</code></pre>\n\n<h4 id=\"set-default-zone\">Set Default Zone</h4>\n\n<pre><code class=\"language-Shell\">firewal-cmd -set-default-zone=&lt;Zone&gt;\n</code></pre>\n\n<h4 id=\"route-all-traffic-from-a-network-into-a-zone\">Route all Traffic from a network into a zone.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-source=&lt;NetWorkOrHost&gt;/&lt;24,etc..&gt;\n</code></pre>\n\n<h4 id=\"route-specific-service-into-a-zone\">Route specific service into a zone</h4>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-service=&lt;ServiceByName&gt;\n</code></pre>\n\n<h3 id=\"remove-a-sevice-from-default-zone\">Remove a sevice from DEFAULT zone</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --remove-service=&lt;ServiceName&gt;\n</code></pre>\n\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "security", "firewall" ], "next": { "title": "route", "categories": [ "Networking" ], "url": "/commands/route.html", "collection": "commands", "id": "/commands/route", "date": "2021-09-29 15:24:26 -0500", "tags": [ "networking", "unix", "smf" ], "relative_path": "_commands/route.md", "path": "_commands/route.md", "draft": false, "updated": "2021-09-22", "slug": "route", "ext": ".md" }, "relative_path": "_commands/firewall-cmd.md", "path": "_commands/firewall-cmd.md", "excerpt": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "firewall-cmd", "ext": ".md" }, "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "excerpt": "<h3 id=\"ausearch\">ausearch</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" }, "url": "/commands/firewall-cmd.html", "collection": "commands", "content": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n\n<p>!!! note Notes</p>\n\n<h4 id=\"firewalld-daemon\">Firewalld Daemon</h4>\n\n<ul>\n <li>Enabled by default on systemd</li>\n <li>Applicaitons and services can all their own rules and exceptions to the firewall.</li>\n <li>The daemon enables the separation of the runtime and permanent configurations.</li>\n <li>The Daemon allows for dynamic amanagement of the firewall and provides support fo the firewall zones.</li>\n</ul>\n\n<h4 id=\"rule-matching-order\">Rule Matching Order</h4>\n\n<ul>\n <li>The Source IP address is checked first.</li>\n <li>The Interface is check if there is no matching rule for the source IP.</li>\n <li>If neither the source or reciving interface match, the default zine is used.</li>\n <li><strong>DENY</strong> takes precidence over <strong>ALLOW</strong>.</li>\n</ul>\n\n<h4 id=\"saving-configuration\">Saving Configuration</h4>\n\n<ul>\n <li>Running configuration is lost if the service is stoped or rebooted before saving.</li>\n <li>Permanent configuration is read at start or at daemon reload.</li>\n</ul>\n\n<h4 id=\"firewall-cmd-1\">Firewall-cmd</h4>\n\n<ul>\n <li>Supports tab completion.</li>\n</ul>\n\n<p>!!!</p>\n\n<hr />\n\n<h4 id=\"zones\">Zones</h4>\n\n<ul>\n <li>trusted</li>\n <li>home</li>\n <li>internal</li>\n <li>work</li>\n <li>public</li>\n <li>external</li>\n <li>dmz</li>\n <li>block</li>\n <li>drop</li>\n</ul>\n\n<hr />\n\n<h4 id=\"configuration-files\">Configuration Files</h4>\n\n<table>\n <thead>\n <tr>\n <th style=\"text-align: left\">File</th>\n <th style=\"text-align: left\">Purpose</th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td style=\"text-align: left\">/usr/lib/firewalld/</td>\n <td style=\"text-align: left\">Defaukt configuration files for firewalld</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/</td>\n <td style=\"text-align: left\">- User defined and system firewalld configurations<br />- If there are no user configurations there may not be any xml files.<br />- If there are user configurations, the file will be names firewalld.conf</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/firewalld.conf</td>\n <td style=\"text-align: left\">User defined configurations. (Mihgt not exist)</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/services</td>\n <td style=\"text-align: left\">User defined services and rules.</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/zones</td>\n <td style=\"text-align: left\">User defined Zones and rules.</td>\n </tr>\n </tbody>\n</table>\n\n<hr />\n\n<h4 id=\"syntax\">Syntax</h4>\n\n<h5 id=\"rich-syntax\">Rich Syntax</h5>\n\n<p>Resource: <strong><a href=\"(https://fedoraproject.org/wiki/Features/FirewalldRichLanguage#Handle_rich_rules_with_the_command_line_client)\">Rich Syntax Arguments</a></strong></p>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'\n</code></pre>\n\n<pre><code class=\"language-shell\">firewall-cmd --add-rich-rule='rule family=ipv4 source address=192.168.1.0/24 service name=ssh log prefix=\"SSH Access\" level=\"notice\" accept'\n</code></pre>\n\n<h5 id=\"direct-syntax\">Direct Syntax</h5>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE\n</code></pre>\n\n<hr />\n\n<h4 id=\"commands\">Commands</h4>\n\n<p>!!! error IMPORTANT!\nAlways add <strong>permanent</strong> to save changes to the firewalld <br />configuration, after Making changes.\n!!!</p>\n\n<h4 id=\"view-rules\">View rules</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --list-all-zones\n</code></pre>\n\n<h3 id=\"list-direct-rules\">List direct rules</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --direct --get-all-rules\n</code></pre>\n\n<h4 id=\"reload-firewalld-with-zero-down-time\">Reload firewalld with zero down-time.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --reload-\n</code></pre>\n\n<h3 id=\"block-outbound-traffic\">Block Outbound traffic</h3>\n<pre><code class=\"language-Shell\">// Can add --dport, --sport\nfirewall-cmd --direct --add-rule ipv4 filter OUTPUT 0 -p tcp -m tcp -d &lt;IPAddress&gt; -j DROP\n</code></pre>\n\n<h4 id=\"set-default-zone\">Set Default Zone</h4>\n\n<pre><code class=\"language-Shell\">firewal-cmd -set-default-zone=&lt;Zone&gt;\n</code></pre>\n\n<h4 id=\"route-all-traffic-from-a-network-into-a-zone\">Route all Traffic from a network into a zone.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-source=&lt;NetWorkOrHost&gt;/&lt;24,etc..&gt;\n</code></pre>\n\n<h4 id=\"route-specific-service-into-a-zone\">Route specific service into a zone</h4>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-service=&lt;ServiceByName&gt;\n</code></pre>\n\n<h3 id=\"remove-a-sevice-from-default-zone\">Remove a sevice from DEFAULT zone</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --remove-service=&lt;ServiceName&gt;\n</code></pre>\n\n", "id": "/commands/firewall-cmd", "output": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n\n<p>!!! note Notes</p>\n\n<h4 id=\"firewalld-daemon\">Firewalld Daemon</h4>\n\n<ul>\n <li>Enabled by default on systemd</li>\n <li>Applicaitons and services can all their own rules and exceptions to the firewall.</li>\n <li>The daemon enables the separation of the runtime and permanent configurations.</li>\n <li>The Daemon allows for dynamic amanagement of the firewall and provides support fo the firewall zones.</li>\n</ul>\n\n<h4 id=\"rule-matching-order\">Rule Matching Order</h4>\n\n<ul>\n <li>The Source IP address is checked first.</li>\n <li>The Interface is check if there is no matching rule for the source IP.</li>\n <li>If neither the source or reciving interface match, the default zine is used.</li>\n <li><strong>DENY</strong> takes precidence over <strong>ALLOW</strong>.</li>\n</ul>\n\n<h4 id=\"saving-configuration\">Saving Configuration</h4>\n\n<ul>\n <li>Running configuration is lost if the service is stoped or rebooted before saving.</li>\n <li>Permanent configuration is read at start or at daemon reload.</li>\n</ul>\n\n<h4 id=\"firewall-cmd-1\">Firewall-cmd</h4>\n\n<ul>\n <li>Supports tab completion.</li>\n</ul>\n\n<p>!!!</p>\n\n<hr />\n\n<h4 id=\"zones\">Zones</h4>\n\n<ul>\n <li>trusted</li>\n <li>home</li>\n <li>internal</li>\n <li>work</li>\n <li>public</li>\n <li>external</li>\n <li>dmz</li>\n <li>block</li>\n <li>drop</li>\n</ul>\n\n<hr />\n\n<h4 id=\"configuration-files\">Configuration Files</h4>\n\n<table>\n <thead>\n <tr>\n <th style=\"text-align: left\">File</th>\n <th style=\"text-align: left\">Purpose</th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td style=\"text-align: left\">/usr/lib/firewalld/</td>\n <td style=\"text-align: left\">Defaukt configuration files for firewalld</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/</td>\n <td style=\"text-align: left\">- User defined and system firewalld configurations<br />- If there are no user configurations there may not be any xml files.<br />- If there are user configurations, the file will be names firewalld.conf</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/firewalld.conf</td>\n <td style=\"text-align: left\">User defined configurations. (Mihgt not exist)</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/services</td>\n <td style=\"text-align: left\">User defined services and rules.</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/zones</td>\n <td style=\"text-align: left\">User defined Zones and rules.</td>\n </tr>\n </tbody>\n</table>\n\n<hr />\n\n<h4 id=\"syntax\">Syntax</h4>\n\n<h5 id=\"rich-syntax\">Rich Syntax</h5>\n\n<p>Resource: <strong><a href=\"(https://fedoraproject.org/wiki/Features/FirewalldRichLanguage#Handle_rich_rules_with_the_command_line_client)\">Rich Syntax Arguments</a></strong></p>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'\n</code></pre>\n\n<pre><code class=\"language-shell\">firewall-cmd --add-rich-rule='rule family=ipv4 source address=192.168.1.0/24 service name=ssh log prefix=\"SSH Access\" level=\"notice\" accept'\n</code></pre>\n\n<h5 id=\"direct-syntax\">Direct Syntax</h5>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE\n</code></pre>\n\n<hr />\n\n<h4 id=\"commands\">Commands</h4>\n\n<p>!!! error IMPORTANT!\nAlways add <strong>permanent</strong> to save changes to the firewalld <br />configuration, after Making changes.\n!!!</p>\n\n<h4 id=\"view-rules\">View rules</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --list-all-zones\n</code></pre>\n\n<h3 id=\"list-direct-rules\">List direct rules</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --direct --get-all-rules\n</code></pre>\n\n<h4 id=\"reload-firewalld-with-zero-down-time\">Reload firewalld with zero down-time.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --reload-\n</code></pre>\n\n<h3 id=\"block-outbound-traffic\">Block Outbound traffic</h3>\n<pre><code class=\"language-Shell\">// Can add --dport, --sport\nfirewall-cmd --direct --add-rule ipv4 filter OUTPUT 0 -p tcp -m tcp -d &lt;IPAddress&gt; -j DROP\n</code></pre>\n\n<h4 id=\"set-default-zone\">Set Default Zone</h4>\n\n<pre><code class=\"language-Shell\">firewal-cmd -set-default-zone=&lt;Zone&gt;\n</code></pre>\n\n<h4 id=\"route-all-traffic-from-a-network-into-a-zone\">Route all Traffic from a network into a zone.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-source=&lt;NetWorkOrHost&gt;/&lt;24,etc..&gt;\n</code></pre>\n\n<h4 id=\"route-specific-service-into-a-zone\">Route specific service into a zone</h4>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-service=&lt;ServiceByName&gt;\n</code></pre>\n\n<h3 id=\"remove-a-sevice-from-default-zone\">Remove a sevice from DEFAULT zone</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --remove-service=&lt;ServiceName&gt;\n</code></pre>\n\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "security", "firewall" ], "next": { "title": "route", "categories": [ "Networking" ], "previous": { "title": "firewall-cmd", "categories": [ "Auditing", "Firewall", "IPTables" ], "previous": { "title": "ausearch", "categories": [ "Auditing" ], "url": "/commands/ausearch.html", "collection": "commands", "id": "/commands/ausearch", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" }, "url": "/commands/firewall-cmd.html", "collection": "commands", "content": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n\n<p>!!! note Notes</p>\n\n<h4 id=\"firewalld-daemon\">Firewalld Daemon</h4>\n\n<ul>\n <li>Enabled by default on systemd</li>\n <li>Applicaitons and services can all their own rules and exceptions to the firewall.</li>\n <li>The daemon enables the separation of the runtime and permanent configurations.</li>\n <li>The Daemon allows for dynamic amanagement of the firewall and provides support fo the firewall zones.</li>\n</ul>\n\n<h4 id=\"rule-matching-order\">Rule Matching Order</h4>\n\n<ul>\n <li>The Source IP address is checked first.</li>\n <li>The Interface is check if there is no matching rule for the source IP.</li>\n <li>If neither the source or reciving interface match, the default zine is used.</li>\n <li><strong>DENY</strong> takes precidence over <strong>ALLOW</strong>.</li>\n</ul>\n\n<h4 id=\"saving-configuration\">Saving Configuration</h4>\n\n<ul>\n <li>Running configuration is lost if the service is stoped or rebooted before saving.</li>\n <li>Permanent configuration is read at start or at daemon reload.</li>\n</ul>\n\n<h4 id=\"firewall-cmd-1\">Firewall-cmd</h4>\n\n<ul>\n <li>Supports tab completion.</li>\n</ul>\n\n<p>!!!</p>\n\n<hr />\n\n<h4 id=\"zones\">Zones</h4>\n\n<ul>\n <li>trusted</li>\n <li>home</li>\n <li>internal</li>\n <li>work</li>\n <li>public</li>\n <li>external</li>\n <li>dmz</li>\n <li>block</li>\n <li>drop</li>\n</ul>\n\n<hr />\n\n<h4 id=\"configuration-files\">Configuration Files</h4>\n\n<table>\n <thead>\n <tr>\n <th style=\"text-align: left\">File</th>\n <th style=\"text-align: left\">Purpose</th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td style=\"text-align: left\">/usr/lib/firewalld/</td>\n <td style=\"text-align: left\">Defaukt configuration files for firewalld</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/</td>\n <td style=\"text-align: left\">- User defined and system firewalld configurations<br />- If there are no user configurations there may not be any xml files.<br />- If there are user configurations, the file will be names firewalld.conf</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/firewalld.conf</td>\n <td style=\"text-align: left\">User defined configurations. (Mihgt not exist)</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/services</td>\n <td style=\"text-align: left\">User defined services and rules.</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/zones</td>\n <td style=\"text-align: left\">User defined Zones and rules.</td>\n </tr>\n </tbody>\n</table>\n\n<hr />\n\n<h4 id=\"syntax\">Syntax</h4>\n\n<h5 id=\"rich-syntax\">Rich Syntax</h5>\n\n<p>Resource: <strong><a href=\"(https://fedoraproject.org/wiki/Features/FirewalldRichLanguage#Handle_rich_rules_with_the_command_line_client)\">Rich Syntax Arguments</a></strong></p>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'\n</code></pre>\n\n<pre><code class=\"language-shell\">firewall-cmd --add-rich-rule='rule family=ipv4 source address=192.168.1.0/24 service name=ssh log prefix=\"SSH Access\" level=\"notice\" accept'\n</code></pre>\n\n<h5 id=\"direct-syntax\">Direct Syntax</h5>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE\n</code></pre>\n\n<hr />\n\n<h4 id=\"commands\">Commands</h4>\n\n<p>!!! error IMPORTANT!\nAlways add <strong>permanent</strong> to save changes to the firewalld <br />configuration, after Making changes.\n!!!</p>\n\n<h4 id=\"view-rules\">View rules</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --list-all-zones\n</code></pre>\n\n<h3 id=\"list-direct-rules\">List direct rules</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --direct --get-all-rules\n</code></pre>\n\n<h4 id=\"reload-firewalld-with-zero-down-time\">Reload firewalld with zero down-time.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --reload-\n</code></pre>\n\n<h3 id=\"block-outbound-traffic\">Block Outbound traffic</h3>\n<pre><code class=\"language-Shell\">// Can add --dport, --sport\nfirewall-cmd --direct --add-rule ipv4 filter OUTPUT 0 -p tcp -m tcp -d &lt;IPAddress&gt; -j DROP\n</code></pre>\n\n<h4 id=\"set-default-zone\">Set Default Zone</h4>\n\n<pre><code class=\"language-Shell\">firewal-cmd -set-default-zone=&lt;Zone&gt;\n</code></pre>\n\n<h4 id=\"route-all-traffic-from-a-network-into-a-zone\">Route all Traffic from a network into a zone.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-source=&lt;NetWorkOrHost&gt;/&lt;24,etc..&gt;\n</code></pre>\n\n<h4 id=\"route-specific-service-into-a-zone\">Route specific service into a zone</h4>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-service=&lt;ServiceByName&gt;\n</code></pre>\n\n<h3 id=\"remove-a-sevice-from-default-zone\">Remove a sevice from DEFAULT zone</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --remove-service=&lt;ServiceName&gt;\n</code></pre>\n\n", "id": "/commands/firewall-cmd", "output": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n\n<p>!!! note Notes</p>\n\n<h4 id=\"firewalld-daemon\">Firewalld Daemon</h4>\n\n<ul>\n <li>Enabled by default on systemd</li>\n <li>Applicaitons and services can all their own rules and exceptions to the firewall.</li>\n <li>The daemon enables the separation of the runtime and permanent configurations.</li>\n <li>The Daemon allows for dynamic amanagement of the firewall and provides support fo the firewall zones.</li>\n</ul>\n\n<h4 id=\"rule-matching-order\">Rule Matching Order</h4>\n\n<ul>\n <li>The Source IP address is checked first.</li>\n <li>The Interface is check if there is no matching rule for the source IP.</li>\n <li>If neither the source or reciving interface match, the default zine is used.</li>\n <li><strong>DENY</strong> takes precidence over <strong>ALLOW</strong>.</li>\n</ul>\n\n<h4 id=\"saving-configuration\">Saving Configuration</h4>\n\n<ul>\n <li>Running configuration is lost if the service is stoped or rebooted before saving.</li>\n <li>Permanent configuration is read at start or at daemon reload.</li>\n</ul>\n\n<h4 id=\"firewall-cmd-1\">Firewall-cmd</h4>\n\n<ul>\n <li>Supports tab completion.</li>\n</ul>\n\n<p>!!!</p>\n\n<hr />\n\n<h4 id=\"zones\">Zones</h4>\n\n<ul>\n <li>trusted</li>\n <li>home</li>\n <li>internal</li>\n <li>work</li>\n <li>public</li>\n <li>external</li>\n <li>dmz</li>\n <li>block</li>\n <li>drop</li>\n</ul>\n\n<hr />\n\n<h4 id=\"configuration-files\">Configuration Files</h4>\n\n<table>\n <thead>\n <tr>\n <th style=\"text-align: left\">File</th>\n <th style=\"text-align: left\">Purpose</th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td style=\"text-align: left\">/usr/lib/firewalld/</td>\n <td style=\"text-align: left\">Defaukt configuration files for firewalld</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/</td>\n <td style=\"text-align: left\">- User defined and system firewalld configurations<br />- If there are no user configurations there may not be any xml files.<br />- If there are user configurations, the file will be names firewalld.conf</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/firewalld.conf</td>\n <td style=\"text-align: left\">User defined configurations. (Mihgt not exist)</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/services</td>\n <td style=\"text-align: left\">User defined services and rules.</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/zones</td>\n <td style=\"text-align: left\">User defined Zones and rules.</td>\n </tr>\n </tbody>\n</table>\n\n<hr />\n\n<h4 id=\"syntax\">Syntax</h4>\n\n<h5 id=\"rich-syntax\">Rich Syntax</h5>\n\n<p>Resource: <strong><a href=\"(https://fedoraproject.org/wiki/Features/FirewalldRichLanguage#Handle_rich_rules_with_the_command_line_client)\">Rich Syntax Arguments</a></strong></p>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'\n</code></pre>\n\n<pre><code class=\"language-shell\">firewall-cmd --add-rich-rule='rule family=ipv4 source address=192.168.1.0/24 service name=ssh log prefix=\"SSH Access\" level=\"notice\" accept'\n</code></pre>\n\n<h5 id=\"direct-syntax\">Direct Syntax</h5>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE\n</code></pre>\n\n<hr />\n\n<h4 id=\"commands\">Commands</h4>\n\n<p>!!! error IMPORTANT!\nAlways add <strong>permanent</strong> to save changes to the firewalld <br />configuration, after Making changes.\n!!!</p>\n\n<h4 id=\"view-rules\">View rules</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --list-all-zones\n</code></pre>\n\n<h3 id=\"list-direct-rules\">List direct rules</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --direct --get-all-rules\n</code></pre>\n\n<h4 id=\"reload-firewalld-with-zero-down-time\">Reload firewalld with zero down-time.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --reload-\n</code></pre>\n\n<h3 id=\"block-outbound-traffic\">Block Outbound traffic</h3>\n<pre><code class=\"language-Shell\">// Can add --dport, --sport\nfirewall-cmd --direct --add-rule ipv4 filter OUTPUT 0 -p tcp -m tcp -d &lt;IPAddress&gt; -j DROP\n</code></pre>\n\n<h4 id=\"set-default-zone\">Set Default Zone</h4>\n\n<pre><code class=\"language-Shell\">firewal-cmd -set-default-zone=&lt;Zone&gt;\n</code></pre>\n\n<h4 id=\"route-all-traffic-from-a-network-into-a-zone\">Route all Traffic from a network into a zone.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-source=&lt;NetWorkOrHost&gt;/&lt;24,etc..&gt;\n</code></pre>\n\n<h4 id=\"route-specific-service-into-a-zone\">Route specific service into a zone</h4>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-service=&lt;ServiceByName&gt;\n</code></pre>\n\n<h3 id=\"remove-a-sevice-from-default-zone\">Remove a sevice from DEFAULT zone</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --remove-service=&lt;ServiceName&gt;\n</code></pre>\n\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "security", "firewall" ], "next": { "title": "route", "categories": [ "Networking" ], "url": "/commands/route.html", "collection": "commands", "id": "/commands/route", "date": "2021-09-29 15:24:26 -0500", "tags": [ "networking", "unix", "smf" ], "relative_path": "_commands/route.md", "path": "_commands/route.md", "draft": false, "updated": "2021-09-22", "slug": "route", "ext": ".md" }, "relative_path": "_commands/firewall-cmd.md", "path": "_commands/firewall-cmd.md", "excerpt": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "firewall-cmd", "ext": ".md" }, "url": "/commands/route.html", "collection": "commands", "content": "<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Add route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route del default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt; gw &lt;Gateway&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route del -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;OldDefaultGatewayIP&gt;\n # Change default gateway.\nroute add default &lt;NewDefaultGatewayIP&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Add static route.\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Delete static route.\n</code></pre>\n", "id": "/commands/route", "output": "<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Add route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route del default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt; gw &lt;Gateway&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route del -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;OldDefaultGatewayIP&gt;\n # Change default gateway.\nroute add default &lt;NewDefaultGatewayIP&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Add static route.\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Delete static route.\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "networking", "unix", "smf" ], "next": null, "relative_path": "_commands/route.md", "path": "_commands/route.md", "excerpt": "<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n", "draft": false, "updated": "2021-09-22", "slug": "route", "ext": ".md" }, "relative_path": "_commands/firewall-cmd.md", "path": "_commands/firewall-cmd.md", "excerpt": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "firewall-cmd", "ext": ".md" } { "title": "route", "categories": [ "Networking" ], "previous": { "title": "firewall-cmd", "categories": [ "Auditing", "Firewall", "IPTables" ], "previous": { "title": "ausearch", "categories": [ "Auditing" ], "previous": { "title": "Auditctl", "categories": [ ], "url": "/commands/auditctl.html", "collection": "commands", "id": "/commands/auditctl", "date": "2021-09-29 15:24:26 -0500", "tags": [ ], "relative_path": "_commands/auditctl.md", "path": "_commands/auditctl.md", "draft": false, "layout": "page", "slug": "auditctl", "ext": ".md" }, "url": "/commands/ausearch.html", "collection": "commands", "content": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "id": "/commands/ausearch", "output": "<h3 id=\"ausearch\">ausearch</h3>\n\n<h4 id=\"find-user-accoutn-creation-dates-and-times\">find user accoutn creation dates and times</h4>\n<pre><code class=\"language-Shell\">ausearch -x useradd -i \n</code></pre>\n<pre><code class=\"language-Shell\">aureport -m | grep &lt;UserName&gt;\n</code></pre>\n\n<h4 id=\"find-when-a-user-ran-a-particular-command\">find when a user ran a particular command.</h4>\n<pre><code class=\"language-Shell\">ausearch -m USER_START -x &lt;Command&gt; -ts DD/MM/YYYY HH:MM:SS | grep &lt;UserName&gt;\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "auditing", "security", "logs" ], "next": { "title": "firewall-cmd", "categories": [ "Auditing", "Firewall", "IPTables" ], "url": "/commands/firewall-cmd.html", "collection": "commands", "id": "/commands/firewall-cmd", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "security", "firewall" ], "relative_path": "_commands/firewall-cmd.md", "path": "_commands/firewall-cmd.md", "draft": false, "updated": "2021-09-27", "slug": "firewall-cmd", "ext": ".md" }, "relative_path": "_commands/ausearch.md", "path": "_commands/ausearch.md", "excerpt": "<h3 id=\"ausearch\">ausearch</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "ausearch", "ext": ".md" }, "url": "/commands/firewall-cmd.html", "collection": "commands", "content": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n\n<p>!!! note Notes</p>\n\n<h4 id=\"firewalld-daemon\">Firewalld Daemon</h4>\n\n<ul>\n <li>Enabled by default on systemd</li>\n <li>Applicaitons and services can all their own rules and exceptions to the firewall.</li>\n <li>The daemon enables the separation of the runtime and permanent configurations.</li>\n <li>The Daemon allows for dynamic amanagement of the firewall and provides support fo the firewall zones.</li>\n</ul>\n\n<h4 id=\"rule-matching-order\">Rule Matching Order</h4>\n\n<ul>\n <li>The Source IP address is checked first.</li>\n <li>The Interface is check if there is no matching rule for the source IP.</li>\n <li>If neither the source or reciving interface match, the default zine is used.</li>\n <li><strong>DENY</strong> takes precidence over <strong>ALLOW</strong>.</li>\n</ul>\n\n<h4 id=\"saving-configuration\">Saving Configuration</h4>\n\n<ul>\n <li>Running configuration is lost if the service is stoped or rebooted before saving.</li>\n <li>Permanent configuration is read at start or at daemon reload.</li>\n</ul>\n\n<h4 id=\"firewall-cmd-1\">Firewall-cmd</h4>\n\n<ul>\n <li>Supports tab completion.</li>\n</ul>\n\n<p>!!!</p>\n\n<hr />\n\n<h4 id=\"zones\">Zones</h4>\n\n<ul>\n <li>trusted</li>\n <li>home</li>\n <li>internal</li>\n <li>work</li>\n <li>public</li>\n <li>external</li>\n <li>dmz</li>\n <li>block</li>\n <li>drop</li>\n</ul>\n\n<hr />\n\n<h4 id=\"configuration-files\">Configuration Files</h4>\n\n<table>\n <thead>\n <tr>\n <th style=\"text-align: left\">File</th>\n <th style=\"text-align: left\">Purpose</th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td style=\"text-align: left\">/usr/lib/firewalld/</td>\n <td style=\"text-align: left\">Defaukt configuration files for firewalld</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/</td>\n <td style=\"text-align: left\">- User defined and system firewalld configurations<br />- If there are no user configurations there may not be any xml files.<br />- If there are user configurations, the file will be names firewalld.conf</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/firewalld.conf</td>\n <td style=\"text-align: left\">User defined configurations. (Mihgt not exist)</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/services</td>\n <td style=\"text-align: left\">User defined services and rules.</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/zones</td>\n <td style=\"text-align: left\">User defined Zones and rules.</td>\n </tr>\n </tbody>\n</table>\n\n<hr />\n\n<h4 id=\"syntax\">Syntax</h4>\n\n<h5 id=\"rich-syntax\">Rich Syntax</h5>\n\n<p>Resource: <strong><a href=\"(https://fedoraproject.org/wiki/Features/FirewalldRichLanguage#Handle_rich_rules_with_the_command_line_client)\">Rich Syntax Arguments</a></strong></p>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'\n</code></pre>\n\n<pre><code class=\"language-shell\">firewall-cmd --add-rich-rule='rule family=ipv4 source address=192.168.1.0/24 service name=ssh log prefix=\"SSH Access\" level=\"notice\" accept'\n</code></pre>\n\n<h5 id=\"direct-syntax\">Direct Syntax</h5>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE\n</code></pre>\n\n<hr />\n\n<h4 id=\"commands\">Commands</h4>\n\n<p>!!! error IMPORTANT!\nAlways add <strong>permanent</strong> to save changes to the firewalld <br />configuration, after Making changes.\n!!!</p>\n\n<h4 id=\"view-rules\">View rules</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --list-all-zones\n</code></pre>\n\n<h3 id=\"list-direct-rules\">List direct rules</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --direct --get-all-rules\n</code></pre>\n\n<h4 id=\"reload-firewalld-with-zero-down-time\">Reload firewalld with zero down-time.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --reload-\n</code></pre>\n\n<h3 id=\"block-outbound-traffic\">Block Outbound traffic</h3>\n<pre><code class=\"language-Shell\">// Can add --dport, --sport\nfirewall-cmd --direct --add-rule ipv4 filter OUTPUT 0 -p tcp -m tcp -d &lt;IPAddress&gt; -j DROP\n</code></pre>\n\n<h4 id=\"set-default-zone\">Set Default Zone</h4>\n\n<pre><code class=\"language-Shell\">firewal-cmd -set-default-zone=&lt;Zone&gt;\n</code></pre>\n\n<h4 id=\"route-all-traffic-from-a-network-into-a-zone\">Route all Traffic from a network into a zone.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-source=&lt;NetWorkOrHost&gt;/&lt;24,etc..&gt;\n</code></pre>\n\n<h4 id=\"route-specific-service-into-a-zone\">Route specific service into a zone</h4>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-service=&lt;ServiceByName&gt;\n</code></pre>\n\n<h3 id=\"remove-a-sevice-from-default-zone\">Remove a sevice from DEFAULT zone</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --remove-service=&lt;ServiceName&gt;\n</code></pre>\n\n", "id": "/commands/firewall-cmd", "output": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n\n<p>!!! note Notes</p>\n\n<h4 id=\"firewalld-daemon\">Firewalld Daemon</h4>\n\n<ul>\n <li>Enabled by default on systemd</li>\n <li>Applicaitons and services can all their own rules and exceptions to the firewall.</li>\n <li>The daemon enables the separation of the runtime and permanent configurations.</li>\n <li>The Daemon allows for dynamic amanagement of the firewall and provides support fo the firewall zones.</li>\n</ul>\n\n<h4 id=\"rule-matching-order\">Rule Matching Order</h4>\n\n<ul>\n <li>The Source IP address is checked first.</li>\n <li>The Interface is check if there is no matching rule for the source IP.</li>\n <li>If neither the source or reciving interface match, the default zine is used.</li>\n <li><strong>DENY</strong> takes precidence over <strong>ALLOW</strong>.</li>\n</ul>\n\n<h4 id=\"saving-configuration\">Saving Configuration</h4>\n\n<ul>\n <li>Running configuration is lost if the service is stoped or rebooted before saving.</li>\n <li>Permanent configuration is read at start or at daemon reload.</li>\n</ul>\n\n<h4 id=\"firewall-cmd-1\">Firewall-cmd</h4>\n\n<ul>\n <li>Supports tab completion.</li>\n</ul>\n\n<p>!!!</p>\n\n<hr />\n\n<h4 id=\"zones\">Zones</h4>\n\n<ul>\n <li>trusted</li>\n <li>home</li>\n <li>internal</li>\n <li>work</li>\n <li>public</li>\n <li>external</li>\n <li>dmz</li>\n <li>block</li>\n <li>drop</li>\n</ul>\n\n<hr />\n\n<h4 id=\"configuration-files\">Configuration Files</h4>\n\n<table>\n <thead>\n <tr>\n <th style=\"text-align: left\">File</th>\n <th style=\"text-align: left\">Purpose</th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td style=\"text-align: left\">/usr/lib/firewalld/</td>\n <td style=\"text-align: left\">Defaukt configuration files for firewalld</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/</td>\n <td style=\"text-align: left\">- User defined and system firewalld configurations<br />- If there are no user configurations there may not be any xml files.<br />- If there are user configurations, the file will be names firewalld.conf</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/firewalld.conf</td>\n <td style=\"text-align: left\">User defined configurations. (Mihgt not exist)</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/services</td>\n <td style=\"text-align: left\">User defined services and rules.</td>\n </tr>\n <tr>\n <td style=\"text-align: left\">/etc/firewalld/zones</td>\n <td style=\"text-align: left\">User defined Zones and rules.</td>\n </tr>\n </tbody>\n</table>\n\n<hr />\n\n<h4 id=\"syntax\">Syntax</h4>\n\n<h5 id=\"rich-syntax\">Rich Syntax</h5>\n\n<p>Resource: <strong><a href=\"(https://fedoraproject.org/wiki/Features/FirewalldRichLanguage#Handle_rich_rules_with_the_command_line_client)\">Rich Syntax Arguments</a></strong></p>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'\n</code></pre>\n\n<pre><code class=\"language-shell\">firewall-cmd --add-rich-rule='rule family=ipv4 source address=192.168.1.0/24 service name=ssh log prefix=\"SSH Access\" level=\"notice\" accept'\n</code></pre>\n\n<h5 id=\"direct-syntax\">Direct Syntax</h5>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE\n</code></pre>\n\n<hr />\n\n<h4 id=\"commands\">Commands</h4>\n\n<p>!!! error IMPORTANT!\nAlways add <strong>permanent</strong> to save changes to the firewalld <br />configuration, after Making changes.\n!!!</p>\n\n<h4 id=\"view-rules\">View rules</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --list-all-zones\n</code></pre>\n\n<h3 id=\"list-direct-rules\">List direct rules</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --direct --get-all-rules\n</code></pre>\n\n<h4 id=\"reload-firewalld-with-zero-down-time\">Reload firewalld with zero down-time.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --reload-\n</code></pre>\n\n<h3 id=\"block-outbound-traffic\">Block Outbound traffic</h3>\n<pre><code class=\"language-Shell\">// Can add --dport, --sport\nfirewall-cmd --direct --add-rule ipv4 filter OUTPUT 0 -p tcp -m tcp -d &lt;IPAddress&gt; -j DROP\n</code></pre>\n\n<h4 id=\"set-default-zone\">Set Default Zone</h4>\n\n<pre><code class=\"language-Shell\">firewal-cmd -set-default-zone=&lt;Zone&gt;\n</code></pre>\n\n<h4 id=\"route-all-traffic-from-a-network-into-a-zone\">Route all Traffic from a network into a zone.</h4>\n\n<pre><code class=\"language-Shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-source=&lt;NetWorkOrHost&gt;/&lt;24,etc..&gt;\n</code></pre>\n\n<h4 id=\"route-specific-service-into-a-zone\">Route specific service into a zone</h4>\n\n<pre><code class=\"language-shell\">firewall-cmd --permanent --zone=&lt;Zone&gt; --add-service=&lt;ServiceByName&gt;\n</code></pre>\n\n<h3 id=\"remove-a-sevice-from-default-zone\">Remove a sevice from DEFAULT zone</h3>\n<pre><code class=\"language-Shell\">firewall-cmd --remove-service=&lt;ServiceName&gt;\n</code></pre>\n\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "security", "firewall" ], "next": { "title": "route", "categories": [ "Networking" ], "previous": { "title": "firewall-cmd", "categories": [ "Auditing", "Firewall", "IPTables" ], "url": "/commands/firewall-cmd.html", "collection": "commands", "id": "/commands/firewall-cmd", "date": "2021-09-29 15:24:26 -0500", "tags": [ "unix", "security", "firewall" ], "relative_path": "_commands/firewall-cmd.md", "path": "_commands/firewall-cmd.md", "draft": false, "updated": "2021-09-27", "slug": "firewall-cmd", "ext": ".md" }, "url": "/commands/route.html", "collection": "commands", "content": "<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Add route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route del default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt; gw &lt;Gateway&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route del -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;OldDefaultGatewayIP&gt;\n # Change default gateway.\nroute add default &lt;NewDefaultGatewayIP&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Add static route.\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Delete static route.\n</code></pre>\n", "id": "/commands/route", "output": "<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Add route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route del default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt; gw &lt;Gateway&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route del -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;OldDefaultGatewayIP&gt;\n # Change default gateway.\nroute add default &lt;NewDefaultGatewayIP&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Add static route.\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Delete static route.\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "networking", "unix", "smf" ], "next": null, "relative_path": "_commands/route.md", "path": "_commands/route.md", "excerpt": "<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n", "draft": false, "updated": "2021-09-22", "slug": "route", "ext": ".md" }, "relative_path": "_commands/firewall-cmd.md", "path": "_commands/firewall-cmd.md", "excerpt": "<h3 id=\"firewall-cmd\">firewall-cmd</h3>\n", "draft": false, "updated": "2021-09-27", "slug": "firewall-cmd", "ext": ".md" }, "url": "/commands/route.html", "collection": "commands", "content": "<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Add route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route del default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt; gw &lt;Gateway&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route del -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;OldDefaultGatewayIP&gt;\n # Change default gateway.\nroute add default &lt;NewDefaultGatewayIP&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Add static route.\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Delete static route.\n</code></pre>\n", "id": "/commands/route", "output": "<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Add route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;RoutedNetwork&gt;/&lt;Netmask&gt; &lt;GatewayToTake&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route del default &lt;IPAddress&gt;\n # Remove default route\n</code></pre>\n\n<pre><code class=\"language-bash\">route add -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt; gw &lt;Gateway&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route del -net &lt;RoutedNetwork&gt; netmask &lt;Netmask255Form&gt;\n # Delete route\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete default &lt;OldDefaultGatewayIP&gt;\n # Change default gateway.\nroute add default &lt;NewDefaultGatewayIP&gt;\n</code></pre>\n\n<pre><code class=\"language-bash\">route add &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Add static route.\n</code></pre>\n\n<pre><code class=\"language-bash\">route delete &lt;Network/CIDR&gt; &lt;LocalInterfaceIP&gt;\n # Delete static route.\n</code></pre>\n", "date": "2021-09-29 15:24:26 -0500", "tags": [ "networking", "unix", "smf" ], "next": null, "relative_path": "_commands/route.md", "path": "_commands/route.md", "excerpt": "<pre><code class=\"language-bash\">route add default &lt;IPAddress&gt;\n # Add default route\n</code></pre>\n", "draft": false, "updated": "2021-09-22", "slug": "route", "ext": ".md" }
GooberFromHell